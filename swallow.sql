/*
 Navicat Premium Data Transfer

 Source Server         : localhost_3306
 Source Server Type    : MySQL
 Source Server Version : 80012
 Source Host           : 127.0.0.1:3306
 Source Schema         : swallow_bishe

 Target Server Type    : MySQL
 Target Server Version : 80012
 File Encoding         : 65001

 Date: 16/06/2024 14:47:15
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for hema
-- ----------------------------
DROP TABLE IF EXISTS `hema`;
CREATE TABLE `hema`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `type` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `filename` varchar(512) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `project_id` int(11) NULL DEFAULT 1,
  `git_addr` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `is_repair` int(11) NULL DEFAULT 0,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 137 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_bin ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of hema
-- ----------------------------
INSERT INTO `hema` VALUES (18, '2024-05-14 20:22:12', 'PHP一句话后门-建议清理', '/data/code/QingScan/11.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (19, '2024-05-14 20:22:12', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/openpoc/thinkphp_rce.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (20, '2024-05-14 20:22:12', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/rouze_d/ThinkPHP_RCE1.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (21, '2024-05-14 20:22:12', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/wuerror/drupal7_geddon2.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (22, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/common.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (23, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/ProcessSafe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (24, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/Proxy.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (25, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/AwvsModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (26, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/BaseModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (27, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/GoogleModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (28, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PluginModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (29, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PocsuiteModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (30, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/ProcessSafeModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (31, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/safe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (32, '2024-05-14 20:22:12', '疑似ASP后门-建议人工确认', '/data/code/QingScan/tools/amd64/murphysec', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (33, '2024-05-14 20:22:12', '疑似PHP后门-建议人工确认', '/data/code/QingScan/tools/pocs/cms/hanc00l/PocsuiteCODING.md', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (34, '2024-05-14 20:22:12', 'JSP可疑文件-具有执行命令的操作，请检查文件', '/data/code/QingScan/tools/pocs/cms/openpoc/zimbra.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (35, '2024-05-27 22:16:05', 'PHP一句话后门-建议清理', '/data/code/QingScan/11.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (36, '2024-05-27 22:16:05', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/openpoc/thinkphp_rce.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (37, '2024-05-27 22:16:05', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/rouze_d/ThinkPHP_RCE1.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (38, '2024-05-27 22:16:05', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/wuerror/drupal7_geddon2.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (39, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/common.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (40, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/ProcessSafe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (41, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/Proxy.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (42, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/AwvsModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (43, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/BaseModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (44, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/GoogleModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (45, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PluginModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (46, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PocsuiteModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (47, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/ProcessSafeModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (48, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/safe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (49, '2024-05-27 22:16:05', '疑似ASP后门-建议人工确认', '/data/code/QingScan/tools/amd64/murphysec', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (50, '2024-05-27 22:16:05', '疑似PHP后门-建议人工确认', '/data/code/QingScan/tools/pocs/cms/hanc00l/PocsuiteCODING.md', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (51, '2024-05-27 22:16:05', 'JSP可疑文件-具有执行命令的操作，请检查文件', '/data/code/QingScan/tools/pocs/cms/openpoc/zimbra.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (52, '2024-05-27 22:16:13', 'PHP一句话后门-建议清理', '/data/code/QingScan/11.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (53, '2024-05-27 22:16:13', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/openpoc/thinkphp_rce.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (54, '2024-05-27 22:16:13', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/rouze_d/ThinkPHP_RCE1.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (55, '2024-05-27 22:16:13', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/wuerror/drupal7_geddon2.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (56, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/common.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (57, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/ProcessSafe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (58, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/Proxy.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (59, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/AwvsModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (60, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/BaseModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (61, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/GoogleModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (62, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PluginModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (63, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PocsuiteModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (64, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/ProcessSafeModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (65, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/safe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (66, '2024-05-27 22:16:13', '疑似ASP后门-建议人工确认', '/data/code/QingScan/tools/amd64/murphysec', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (67, '2024-05-27 22:16:13', '疑似PHP后门-建议人工确认', '/data/code/QingScan/tools/pocs/cms/hanc00l/PocsuiteCODING.md', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (68, '2024-05-27 22:16:13', 'JSP可疑文件-具有执行命令的操作，请检查文件', '/data/code/QingScan/tools/pocs/cms/openpoc/zimbra.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (69, '2024-05-27 22:16:24', 'PHP一句话后门-建议清理', '/data/code/QingScan/11.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (70, '2024-05-27 22:16:24', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/openpoc/thinkphp_rce.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (71, '2024-05-27 22:16:24', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/rouze_d/ThinkPHP_RCE1.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (72, '2024-05-27 22:16:24', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/wuerror/drupal7_geddon2.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (73, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/common.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (74, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/ProcessSafe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (75, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/Proxy.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (76, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/AwvsModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (77, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/BaseModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (78, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/GoogleModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (79, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PluginModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (80, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PocsuiteModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (81, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/ProcessSafeModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (82, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/safe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (83, '2024-05-27 22:16:24', '疑似ASP后门-建议人工确认', '/data/code/QingScan/tools/amd64/murphysec', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (84, '2024-05-27 22:16:24', '疑似PHP后门-建议人工确认', '/data/code/QingScan/tools/pocs/cms/hanc00l/PocsuiteCODING.md', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (85, '2024-05-27 22:16:24', 'JSP可疑文件-具有执行命令的操作，请检查文件', '/data/code/QingScan/tools/pocs/cms/openpoc/zimbra.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (86, '2024-05-27 22:16:33', 'PHP一句话后门-建议清理', '/data/code/QingScan/11.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (87, '2024-05-27 22:16:33', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/openpoc/thinkphp_rce.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (88, '2024-05-27 22:16:33', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/rouze_d/ThinkPHP_RCE1.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (89, '2024-05-27 22:16:33', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/wuerror/drupal7_geddon2.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (90, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/common.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (91, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/ProcessSafe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (92, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/Proxy.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (93, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/AwvsModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (94, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/BaseModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (95, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/GoogleModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (96, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PluginModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (97, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PocsuiteModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (98, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/ProcessSafeModel.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (99, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/safe.php', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (100, '2024-05-27 22:16:33', '疑似ASP后门-建议人工确认', '/data/code/QingScan/tools/amd64/murphysec', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (101, '2024-05-27 22:16:33', '疑似PHP后门-建议人工确认', '/data/code/QingScan/tools/pocs/cms/hanc00l/PocsuiteCODING.md', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (102, '2024-05-27 22:16:33', 'JSP可疑文件-具有执行命令的操作，请检查文件', '/data/code/QingScan/tools/pocs/cms/openpoc/zimbra.py', 2, 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `hema` VALUES (103, '2024-05-27 22:17:18', 'PHP一句话后门-建议清理', '/data/code/QingScan/11.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (104, '2024-05-27 22:17:18', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/openpoc/thinkphp_rce.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (105, '2024-05-27 22:17:18', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/rouze_d/ThinkPHP_RCE1.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (106, '2024-05-27 22:17:18', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/wuerror/drupal7_geddon2.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (107, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/common.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (108, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/ProcessSafe.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (109, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/Proxy.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (110, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/AwvsModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (111, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/BaseModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (112, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/GoogleModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (113, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PluginModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (114, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PocsuiteModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (115, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/ProcessSafeModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (116, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/safe.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (117, '2024-05-27 22:17:18', '疑似ASP后门-建议人工确认', '/data/code/QingScan/tools/amd64/murphysec', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (118, '2024-05-27 22:17:18', '疑似PHP后门-建议人工确认', '/data/code/QingScan/tools/pocs/cms/hanc00l/PocsuiteCODING.md', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (119, '2024-05-27 22:17:18', 'JSP可疑文件-具有执行命令的操作，请检查文件', '/data/code/QingScan/tools/pocs/cms/openpoc/zimbra.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (120, '2024-05-27 22:19:00', 'PHP一句话后门-建议清理', '/data/code/QingScan/11.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (121, '2024-05-27 22:19:00', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/openpoc/thinkphp_rce.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (122, '2024-05-27 22:19:00', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/rouze_d/ThinkPHP_RCE1.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (123, '2024-05-27 22:19:00', 'PHP一句话后门-建议清理', '/data/code/QingScan/tools/pocs/cms/wuerror/drupal7_geddon2.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (124, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/common.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (125, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/ProcessSafe.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (126, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/controller/Proxy.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (127, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/AwvsModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (128, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/BaseModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (129, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/GoogleModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (130, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PluginModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (131, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/PocsuiteModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (132, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/code/app/model/ProcessSafeModel.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (133, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/safe.php', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (134, '2024-05-27 22:19:00', '疑似ASP后门-建议人工确认', '/data/code/QingScan/tools/amd64/murphysec', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (135, '2024-05-27 22:19:00', '疑似PHP后门-建议人工确认', '/data/code/QingScan/tools/pocs/cms/hanc00l/PocsuiteCODING.md', 2, 'https://gitee.com/songboy/QingScan.git', 0);
INSERT INTO `hema` VALUES (136, '2024-05-27 22:19:00', 'JSP可疑文件-具有执行命令的操作，请检查文件', '/data/code/QingScan/tools/pocs/cms/openpoc/zimbra.py', 2, 'https://gitee.com/songboy/QingScan.git', 0);

-- ----------------------------
-- Table structure for codeql
-- ----------------------------
DROP TABLE IF EXISTS `codeql`;
CREATE TABLE `codeql`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `ruleId` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `message` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `locations` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `codeFlows` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `project_id` int(11) NOT NULL DEFAULT 0,
  `prompt` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `ai_message` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 48 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of codeql
-- ----------------------------
INSERT INTO `codeql` VALUES (1, 'py/untrusted-data-to-external-api', 'Call to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":346,\"startColumn\":63,\"endColumn\":67}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":331,\"startColumn\":17,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":36,\"endLine\":333,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":335,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":346,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":331,\"startColumn\":17,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":36,\"endLine\":333,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":335,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":346,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":331,\"startColumn\":17,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":36,\"endLine\":333,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":335,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":346,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":331,\"startColumn\":17,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":36,\"endLine\":333,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":329,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":335,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":346,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 346\n\n漏洞描述:\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 757 到 757 ）：\n            status,resheader,body=web.__routes(self,reqheader)\n\n\n代码 kcweb/app.py 片段（行 420 到 420 ）：\n    def __routes(self,header):\n\n\n代码 kcweb/app.py 片段（行 425 到 425 ）：\n        PATH_INFO=header[\'PATH_INFO\'].split(\'/\')\n\n\n代码 kcweb/app.py 片段（行 428 到 428 ）：\n        methods,modular,plug,files,funct,param=web.defaultroute(self,header,PATH_INFO)\n\n\n代码 kcweb/app.py 片段（行 259 到 259 ）：\n    def defaultroute(self,header,PATH_INFO):\n\n\n代码 kcweb/app.py 片段（行 331 到 331 ）：\n                PATH_INFO,\n\n\n代码 kcweb/app.py 片段（行 196 到 196 ）：\n    def __getconfigroute(self,PATH_INFO,header):\n\n\n代码 kcweb/app.py 片段（行 232 到 232 ）：\n        return routedefault,PATH_INFO\n\n\n代码 kcweb/app.py 片段（行 329 到 333 ）：\n            routedefault,PATH_INFO=web.__getconfigroute(\n                self,\n                PATH_INFO,\n                header\n            )\n\n\n代码 kcweb/app.py 片段（行 329 到 329 ）：\n            routedefault,PATH_INFO=web.__getconfigroute(\n\n\n代码 kcweb/app.py 片段（行 335 到 335 ）：\n                for path in PATH_INFO:\n\n\n代码 kcweb/app.py 片段（行 346 到 346 ）：\n                            param.append(urllib.parse.unquote(path))\n\n\n\n-------------------------------', '根据提供的审计提示，存在`py/untrusted-data-to-external-api`类型的漏洞。这个漏洞发生在`kcweb/app.py`文件中，具体是在`urllib.parse.unquote`函数被用于处理可能不受信任的数据。`urllib.parse.unquote`通常用于解码URL中的百分号编码，如果直接使用未经验证的用户输入，可能会导致安全风险，比如恶意注入攻击。\n\n为了修复这个问题，你需要确保在调用`urllib.parse.unquote`之前对`PATH_INFO`或任何来自外部接口的数据进行适当的清理和验证。以下是一些建议的修复步骤：\n\n1. **数据验证：** 在将用户输入或请求参数传递给`urllib.parse.unquote`之前，检查它们是否符合预期格式，例如，只包含合法字符，并且没有潜在的恶意编码。\n\n2. **参数化查询：** 如果`PATH_INFO`包含动态部分，考虑使用参数化查询来防止SQL注入等攻击。\n\n3. **使用安全的方法：** 使用`safe`参数来指定哪些字符可以被视为安全的，例如，`urllib.parse.unquote_plus`方法可以防止特殊字符的编码被误解。\n\n4. **输入转义：** 对用户输入进行适当的转义，例如，使用`cgi.escape`或类似函数。\n\n5. **代码重构：** 如果可能，考虑重构代码，避免直接访问和操作环境变量或URL路径，而是通过预定义的函数或对象来处理这些值。\n\n请确保在修改后进行充分的测试，包括边缘情况和异常输入，以确保修复有效。同时，定期更新依赖库，因为可能存在已知的安全补丁。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (2, 'py/untrusted-data-to-external-api', 'Call to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":370,\"startColumn\":55,\"endColumn\":60}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":290,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":40,\"endLine\":292,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":294,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":655,\"startColumn\":13,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":669,\"startColumn\":16,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":46,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":33,\"endColumn\":38}},\"message\":{\"text\":\"[post] ControlFlowNode for param\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":370,\"startColumn\":55,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for param\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":715,\"startColumn\":25,\"endColumn\":41}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key PATH_INFO]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key PATH_INFO]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key PATH_INFO]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header [Dictionary element at key PATH_INFO]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":19,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for header [Dictionary element at key PATH_INFO]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":19,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":308,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":29,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":40,\"endLine\":310,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute() [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":17,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":312,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":655,\"startColumn\":13,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":666,\"startColumn\":33,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":623,\"startColumn\":22,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":635,\"startColumn\":16,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":666,\"startColumn\":16,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for unquote_to_bytes()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":666,\"startColumn\":16,\"endColumn\":65}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":46,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":33,\"endColumn\":38}},\"message\":{\"text\":\"[post] ControlFlowNode for param\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":370,\"startColumn\":55,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for param\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":290,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":40,\"endLine\":292,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":294,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":655,\"startColumn\":13,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":669,\"startColumn\":16,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":46,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":33,\"endColumn\":38}},\"message\":{\"text\":\"[post] ControlFlowNode for param\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":370,\"startColumn\":55,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for param\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":308,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":29,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":40,\"endLine\":310,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute() [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":17,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":312,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":655,\"startColumn\":13,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":666,\"startColumn\":33,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":623,\"startColumn\":22,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":635,\"startColumn\":16,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for string\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":666,\"startColumn\":16,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for unquote_to_bytes()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/urllib\\/parse.py\",\"index\":1},\"region\":{\"startLine\":666,\"startColumn\":16,\"endColumn\":65}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":46,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":33,\"endColumn\":38}},\"message\":{\"text\":\"[post] ControlFlowNode for param\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":370,\"startColumn\":55,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for param\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 370\n\n漏洞描述:\nCall to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.tuple \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 757 到 757 ）：\n            status,resheader,body=web.__routes(self,reqheader)\n\n\n代码 kcweb/app.py 片段（行 420 到 420 ）：\n    def __routes(self,header):\n\n\n代码 kcweb/app.py 片段（行 425 到 425 ）：\n        PATH_INFO=header[\'PATH_INFO\'].split(\'/\')\n\n\n代码 kcweb/app.py 片段（行 428 到 428 ）：\n        methods,modular,plug,files,funct,param=web.defaultroute(self,header,PATH_INFO)\n\n\n代码 kcweb/app.py 片段（行 259 到 259 ）：\n    def defaultroute(self,header,PATH_INFO):\n\n\n代码 kcweb/app.py 片段（行 290 到 290 ）：\n                    PATH_INFO,\n\n\n代码 kcweb/app.py 片段（行 196 到 196 ）：\n    def __getconfigroute(self,PATH_INFO,header):\n\n\n代码 kcweb/app.py 片段（行 232 到 232 ）：\n        return routedefault,PATH_INFO\n\n\n代码 kcweb/app.py 片段（行 288 到 292 ）：\n                routedefault,PATH_INFO=web.__getconfigroute(\n                    self,\n                    PATH_INFO,\n                    header\n                )\n\n\n代码 kcweb/app.py 片段（行 288 到 288 ）：\n                routedefault,PATH_INFO=web.__getconfigroute(\n\n\n代码 kcweb/app.py 片段（行 294 到 294 ）：\n                    for path in PATH_INFO:\n\n\n代码 kcweb/app.py 片段（行 303 到 303 ）：\n                                param.append(urllib.parse.unquote(path))\n\n\n代码 file:/usr/lib/python3.10/urllib/parse.py 片段（行 655 到 655 ）：\ndef unquote(string, encoding=\'utf-8\', errors=\'replace\'):\n\n\n代码 file:/usr/lib/python3.10/urllib/parse.py 片段（行 669 到 669 ）：\n        return string\n\n\n代码 kcweb/app.py 片段（行 303 到 303 ）：\n                                param.append(urllib.parse.unquote(path))\n\n\n代码 kcweb/app.py 片段（行 303 到 303 ）：\n                                param.append(urllib.parse.unquote(path))\n\n\n代码 kcweb/app.py 片段（行 370 到 370 ）：\n        return methods,modular,plug,files,funct,tuple(param)\n\n\n\n-------------------------------', '看起来你提供的是一份关于Python Web应用kcweb中可能存在安全漏洞的审计报告。这个漏洞类型`py/untrusted-data-to-external-api`表明有未经过验证的数据被传递给了外部API，这可能导致潜在的安全风险，比如SQL注入、跨站脚本攻击等。\n\n在这些代码片段中，存在多个地方使用了`tuple(param)`，其中`param`可能包含用户输入的数据，没有进行适当的清理和验证就直接构造元组。这可能导致将未经处理的用户数据直接传递给后续函数或API调用，如果用户输入包含恶意内容，可能会对系统造成影响。\n\n为修复这个问题，你应该确保对用户输入的参数进行适当的验证和清理，例如：\n\n1. 对`param`中的每个元素进行转义或编码，以防止特殊字符被误解。\n2. 使用参数化查询，避免字符串拼接时的SQL注入风险。\n3. 如果是URI路径，确保正确处理和解析，不要直接使用`unquote`函数暴露敏感信息。\n\n请检查这些代码片段，并根据需要修改它们，确保所有与外部接口交互的数据都经过了安全处理。同时，可能还需要审查其他部分的代码，看看是否存在类似的潜在问题。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (3, 'py/untrusted-data-to-external-api', 'Call to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":67,\"endColumn\":71}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":290,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":40,\"endLine\":292,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":294,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":290,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":40,\"endLine\":292,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":294,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":290,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":40,\"endLine\":292,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":294,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":290,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":40,\"endLine\":292,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":288,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":294,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":303,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 303\n\n漏洞描述:\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 757 到 757 ）：\n            status,resheader,body=web.__routes(self,reqheader)\n\n\n代码 kcweb/app.py 片段（行 420 到 420 ）：\n    def __routes(self,header):\n\n\n代码 kcweb/app.py 片段（行 425 到 425 ）：\n        PATH_INFO=header[\'PATH_INFO\'].split(\'/\')\n\n\n代码 kcweb/app.py 片段（行 428 到 428 ）：\n        methods,modular,plug,files,funct,param=web.defaultroute(self,header,PATH_INFO)\n\n\n代码 kcweb/app.py 片段（行 259 到 259 ）：\n    def defaultroute(self,header,PATH_INFO):\n\n\n代码 kcweb/app.py 片段（行 290 到 290 ）：\n                    PATH_INFO,\n\n\n代码 kcweb/app.py 片段（行 196 到 196 ）：\n    def __getconfigroute(self,PATH_INFO,header):\n\n\n代码 kcweb/app.py 片段（行 232 到 232 ）：\n        return routedefault,PATH_INFO\n\n\n代码 kcweb/app.py 片段（行 288 到 292 ）：\n                routedefault,PATH_INFO=web.__getconfigroute(\n                    self,\n                    PATH_INFO,\n                    header\n                )\n\n\n代码 kcweb/app.py 片段（行 288 到 288 ）：\n                routedefault,PATH_INFO=web.__getconfigroute(\n\n\n代码 kcweb/app.py 片段（行 294 到 294 ）：\n                    for path in PATH_INFO:\n\n\n代码 kcweb/app.py 片段（行 303 到 303 ）：\n                                param.append(urllib.parse.unquote(path))\n\n\n\n-------------------------------', '根据提供的审计提示，存在`py/untrusted-data-to-external-api`类型的漏洞。在`kcweb/app.py`文件中，多个位置使用了`urllib.parse.unquote`函数处理来自环境变量`env`和`Attribute()`的未经验证数据。`urllib.parse.unquote`通常用于解码URL中的百分号编码，如果输入不可信，这可能导致潜在的安全风险，如SQL注入、跨站脚本攻击（XSS）或其他恶意数据的执行。\n\n修复这种漏洞的关键是确保在调用`unquote`之前对输入数据进行适当的验证和清理。以下是一些建议来修复这些问题：\n\n1. 对`env`和`Attribute()`的值进行检查，确保它们是安全的URL路径组件。\n2. 如果`PATH_INFO`是从用户输入获取的，对其进行适当的预处理和转义，确保只有预期的字符被传递给`unquote`。\n3. 使用参数化查询或模板引擎，避免直接拼接字符串以构建API请求，这样可以防止注入攻击。\n4. 对`routedefault,PATH_INFO`等可能包含用户输入的部分进行同样的处理，确保它们在调用`__getconfigroute`时已经安全。\n\n具体修复代码示例可能因项目结构和代码规范而异，但应该遵循这些指导原则。记得在实际修复时，确保遵循代码审查的最佳实践，并在重构代码时考虑可维护性和安全性。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (4, 'py/untrusted-data-to-external-api', 'Call to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":364,\"startColumn\":63,\"endColumn\":67}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":62,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":36,\"endColumn\":79}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":351,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":364,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":62,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":36,\"endColumn\":79}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":351,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":364,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":62,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":36,\"endColumn\":79}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":351,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":364,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":62,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":36,\"endColumn\":79}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":349,\"startColumn\":26,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":351,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":364,\"startColumn\":63,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 364\n\n漏洞描述:\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 757 到 757 ）：\n            status,resheader,body=web.__routes(self,reqheader)\n\n\n代码 kcweb/app.py 片段（行 420 到 420 ）：\n    def __routes(self,header):\n\n\n代码 kcweb/app.py 片段（行 425 到 425 ）：\n        PATH_INFO=header[\'PATH_INFO\'].split(\'/\')\n\n\n代码 kcweb/app.py 片段（行 428 到 428 ）：\n        methods,modular,plug,files,funct,param=web.defaultroute(self,header,PATH_INFO)\n\n\n代码 kcweb/app.py 片段（行 259 到 259 ）：\n    def defaultroute(self,header,PATH_INFO):\n\n\n代码 kcweb/app.py 片段（行 349 到 349 ）：\n            routedefault,PATH_INFO=web.__getconfigroute(self,PATH_INFO,header)\n\n\n代码 kcweb/app.py 片段（行 196 到 196 ）：\n    def __getconfigroute(self,PATH_INFO,header):\n\n\n代码 kcweb/app.py 片段（行 232 到 232 ）：\n        return routedefault,PATH_INFO\n\n\n代码 kcweb/app.py 片段（行 349 到 349 ）：\n            routedefault,PATH_INFO=web.__getconfigroute(self,PATH_INFO,header)\n\n\n代码 kcweb/app.py 片段（行 349 到 349 ）：\n            routedefault,PATH_INFO=web.__getconfigroute(self,PATH_INFO,header)\n\n\n代码 kcweb/app.py 片段（行 351 到 351 ）：\n                for path in PATH_INFO:\n\n\n代码 kcweb/app.py 片段（行 364 到 364 ）：\n                            param.append(urllib.parse.unquote(path))\n\n\n\n-------------------------------', '这段审计提示指出在 `kcweb/app.py` 文件中存在四个潜在的 `py/untrusted-data-to-external-api` 类型漏洞。问题出在第 364 行，调用了 `urllib.parse.unquote` 函数，该函数处理可能来自用户输入或环境变量（如 `env` 和 `Attribute()`）的未经验证数据。这可能导致恶意数据被错误地解码，从而影响到外部 API 的请求。\n\n为了修复这个漏洞，你需要确保对传递给 `urllib.parse.unquote` 的参数进行适当的验证和清理，防止恶意用户利用它来执行非预期的操作。具体步骤可能包括：\n\n1. **数据验证**：检查 `path` 是否包含可能引起安全问题的字符，并且只对可信来源的数据进行解码。\n2. **参数化查询**：如果 `path` 是从用户输入或请求中获取的，确保使用参数化查询（如 SQL 预编译语句）来避免 SQL 注入攻击。\n3. **使用安全的函数**：考虑使用专门设计用于处理用户输入的安全函数，这些函数会自动进行必要的转义和验证。\n4. **异常处理**：对于任何可能的异常或无效输入，应捕获并记录错误，而不是直接让它们影响外部 API。\n\n请根据你的应用架构和安全策略更新相应的代码，确保对用户提供的数据进行适当的处理。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (5, 'py/untrusted-data-to-external-api', 'Call to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":67,\"endColumn\":71}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":308,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":40,\"endLine\":310,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":312,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":308,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":40,\"endLine\":310,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":312,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":308,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":40,\"endLine\":310,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":312,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":757,\"startColumn\":53,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":420,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for header\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":425,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":428,\"startColumn\":77,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":259,\"startColumn\":34,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":308,\"startColumn\":21,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":196,\"startColumn\":31,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":232,\"startColumn\":16,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":40,\"endLine\":310,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":306,\"startColumn\":30,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for PATH_INFO\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":312,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":323,\"startColumn\":67,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 323\n\n漏洞描述:\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to urllib.parse.unquote \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 757 到 757 ）：\n            status,resheader,body=web.__routes(self,reqheader)\n\n\n代码 kcweb/app.py 片段（行 420 到 420 ）：\n    def __routes(self,header):\n\n\n代码 kcweb/app.py 片段（行 425 到 425 ）：\n        PATH_INFO=header[\'PATH_INFO\'].split(\'/\')\n\n\n代码 kcweb/app.py 片段（行 428 到 428 ）：\n        methods,modular,plug,files,funct,param=web.defaultroute(self,header,PATH_INFO)\n\n\n代码 kcweb/app.py 片段（行 259 到 259 ）：\n    def defaultroute(self,header,PATH_INFO):\n\n\n代码 kcweb/app.py 片段（行 308 到 308 ）：\n                    PATH_INFO,\n\n\n代码 kcweb/app.py 片段（行 196 到 196 ）：\n    def __getconfigroute(self,PATH_INFO,header):\n\n\n代码 kcweb/app.py 片段（行 232 到 232 ）：\n        return routedefault,PATH_INFO\n\n\n代码 kcweb/app.py 片段（行 306 到 310 ）：\n                routedefault,PATH_INFO=web.__getconfigroute(\n                    self,\n                    PATH_INFO,\n                    header\n                )\n\n\n代码 kcweb/app.py 片段（行 306 到 306 ）：\n                routedefault,PATH_INFO=web.__getconfigroute(\n\n\n代码 kcweb/app.py 片段（行 312 到 312 ）：\n                    for path in PATH_INFO:\n\n\n代码 kcweb/app.py 片段（行 323 到 323 ）：\n                                param.append(urllib.parse.unquote(path))\n\n\n\n-------------------------------', '根据提供的审计提示，存在`py/untrusted-data-to-external-api`类型的漏洞，涉及在`kcweb/app.py`文件中使用`urllib.parse.unquote`函数处理可能未验证的用户输入数据。具体来说，这个函数在第323行被用于`param.append`操作，这意味着它可能将用户请求中的URI路径参数未经安全检查就传递给了外部API。\n\n为修复这个问题，你需要确保对来自用户的输入进行适当的清理和验证，以防止恶意编码或SQL注入等攻击。以下是一些建议：\n\n1. 对`PATH_INFO`和任何其他来自用户输入的数据进行规范化和转义处理。\n2. 使用`safe`参数来限制`urllib.parse.unquote`的解析行为，只允许预期的字符。\n3. 在调用外部API之前，使用正则表达式、白名单或其他验证方法来检查输入是否符合预期格式。\n4. 如果`param`列表是动态生成的，确保在添加到列表之前每个元素都经过了安全处理。\n\n修改后的代码片段示例：\n\n```python\n# 示例：假设你已经对PATH_INFO进行了验证\ncleaned_path = self.validate_path(PATH_INFO)\nparam.append(urllib.parse.unquote(cleaned_path, safe=\':/\'))  # 使用safe参数限制解析\n```\n\n请确保在整个代码库中执行类似的检查，以确保所有可能的用户输入点都受到保护。同时，定期更新和审查安全策略，保持与最新威胁情报的同步。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (6, 'py/untrusted-data-to-external-api', 'Call to cgi.FieldStorage \\[keyword fp\\] with untrusted data from [ControlFlowNode for env](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":41,\"endColumn\":58}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":41,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 678\n\n漏洞描述:\nCall to cgi.FieldStorage \\[keyword fp\\] with untrusted data from [ControlFlowNode for env](1).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 678 到 678 ）：\n            files = cgi.FieldStorage(fp=env[\'wsgi.input\'], environ=env, keep_blank_values=True)\n\n\n\n-------------------------------', '你好，根据提供的审计提示，这是一个与Python CGI相关的安全问题。在`kcweb/app.py`的第678行，代码试图使用`cgi.FieldStorage`来处理来自环境变量`env[\'wsgi.input\']`的用户输入数据。`FieldStorage`通常用于处理表单数据，但如果没有正确验证和清理用户提供的数据，就可能存在注入风险，因为`fp`参数接受的是一个文件对象，如果用户能够控制这个输入，可能会导致外部API被恶意调用或数据泄露。\n\n为了修复这个问题，你应该确保对用户输入进行适当的验证和清理，例如：\n\n1. **检查数据类型**：确保`env[\'wsgi.input\']`确实是一个有效的输入流。\n2. **限制字段**：只允许预期的字段通过，避免处理未知或不受信任的数据。\n3. **转义特殊字符**：对用户提供的任何字符串进行适当的转义，以防止SQL注入或其他格式化字符串攻击。\n4. **使用安全的API调用**：如果你确实需要将用户数据发送到外部API，确保使用安全的方法，比如参数化查询或使用受信任的库来执行请求。\n\n记得始终遵循最小权限原则，仅允许应用程序访问它需要的资源。如果你不确定如何处理，可以查阅相关文档或寻求安全专家的帮助。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (7, 'py/untrusted-data-to-external-api', 'Call to cgi.FieldStorage \\[keyword environ\\] with untrusted data from [ControlFlowNode for env](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":68,\"endColumn\":71}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":68,\"endColumn\":71}},\"message\":{\"text\":\"ControlFlowNode for env\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 678\n\n漏洞描述:\nCall to cgi.FieldStorage \\[keyword environ\\] with untrusted data from [ControlFlowNode for env](1).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 678 到 678 ）：\n            files = cgi.FieldStorage(fp=env[\'wsgi.input\'], environ=env, keep_blank_values=True)\n\n\n\n-------------------------------', '你好，根据提供的审计提示，这段代码可能存在一个安全风险。`cgi.FieldStorage` 是一个用于处理通过 `CGI` (Common Gateway Interface) 传递的表单数据的类。当你将 `environ` 作为参数传递给它时，如果没有正确验证或过滤 `env` 中的数据，就可能引入了未授权的数据到外部 API 调用中，这可能导致数据泄露、注入攻击或其他安全问题。\n\n为了修复这个漏洞，你需要确保在使用 `environ` 之前，对其中的值进行适当的验证和清理，特别是那些可能包含用户输入的部分。这通常包括：\n\n1. **输入验证**：检查 `env` 是否包含预期的键，并且值类型合适。\n2. **参数转义**：对于任何要插入到字符串中的用户输入，使用适当的转义函数，如 `quote_plus()` 或 `html.escape()`。\n3. **防止恶意请求**：检查请求头和查询参数，避免执行不必要的外部操作，比如允许用户控制API调用的URL或参数。\n\n这里是修复后的片段示例（简化版）：\n\n```python\ndef __application(self, env, start_response):\n    # 先验证 env[\'wsgi.input\'] 和 environ 的安全性\n    if \'wsgi.input\' in env and isinstance(env[\'wsgi.input\'], io.IOBase) and \'REQUEST_METHOD\' in env:\n        # 使用安全的方法读取和处理 FieldStorage\n        sanitized_environ = {k: v for k, v in env.items() if k not in [\'wsgi.input\', ...]}  # 只保留必要的环境变量\n        files = cgi.FieldStorage(fp=env[\'wsgi.input\'], environ=sanitized_environ, keep_blank_values=True)\n    else:\n        files = None  # 或者抛出异常，根据你的错误处理策略\n\n    # 然后继续处理 files 对象...\n```\n\n请确保在实际应用中实现更全面的安全措施，包括但不限于使用参数校验库（如`Flask-WTF`或`WTForms`），以及遵循现代Web开发的最佳实践。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (8, 'py/untrusted-data-to-external-api', 'Call to posixpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to ntpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to posixpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to ntpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":24,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"[post] ControlFlowNode for env [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for env [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 728\n\n漏洞描述:\nCall to posixpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to ntpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to posixpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to ntpath.isfile \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 728 到 728 ）：\n        if os.path.isfile(p):\n\n\n\n-------------------------------', '这个审计提示指出在 `kcweb/app.py` 文件的第 728 行存在一个潜在的安全漏洞，类型为 `py/untrusted-data-to-external-api`。问题出在使用 `os.path.isfile()` 函数时，该函数接受未经过验证的数据作为参数 `p`。`p` 是由用户输入（可能包含不受信任的部分）构建的，比如 `reqheader[\'RAW_URI\']`，然后拼接到了静态资源路径上。\n\n由于没有对用户提供的 `RAW_URI` 进行适当的过滤或安全检查，恶意用户可能会尝试利用这个漏洞来访问系统中不应该被他们访问的文件，如敏感配置文件或服务器上的其他文件。为了修复这个问题，你需要确保在调用 `os.path.isfile()` 之前，对 `RAW_URI` 或相关数据进行校验和清理，以防止路径遍历攻击或其他安全风险。例如，可以使用 `urlparse` 函数解析并限制允许的路径部分，或者使用安全的文件系统访问函数（如 `pathlib.Path.exists()`）来代替。记得在处理用户输入时始终遵循最小权限原则和输入验证最佳实践。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (9, 'py/untrusted-data-to-external-api', 'Call to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 740\n\n漏洞描述:\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 740 到 740 ）：\n                    f=open(p,\"rb\")\n\n\n\n-------------------------------', '您好，根据提供的审计提示，这个漏洞类型 `py/untrusted-data-to-external-api` 表明在 Python 代码中，存在使用未经验证的数据 `p` 调用 `open()` 函数，这可能导致安全风险。`p` 是一个可能由用户输入或环境变量构建的字符串，没有进行充分的过滤或验证就直接用于打开文件。\n\n具体到 `kcweb/app.py` 文件的第 740 行，这段代码片段：\n\n```python\nf = open(p, \"rb\")\n```\n\n如果 `p` 包含恶意的文件路径，攻击者可能会利用它来读取、写入或者执行系统上的任意文件，造成潜在的安全威胁。\n\n为了修复这个漏洞，你应该对 `p` 进行适当的验证和清理，确保它只包含预期的、安全的文件路径。例如，可以使用 `os.path.join()` 或 `safe_join()` 函数来组合路径，避免使用用户提供的字符串直接拼接。同时，考虑使用异常处理来捕获并处理可能出现的非法路径错误。\n\n请检查相关代码，确保对所有可能影响文件操作的输入进行安全处理，并更新你的应用程序以防止此类漏洞。如果你不确定如何修复，建议查阅安全最佳实践或咨询安全专家。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (10, 'py/untrusted-data-to-external-api', 'Call to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/app.py\n行号: 748\n\n漏洞描述:\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 748 到 748 ）：\n                    f=open(p,\"rb\")\n\n\n\n-------------------------------', '您好，根据提供的审计提示，这个漏洞类型 `py/untrusted-data-to-external-api` 表明在 `kcweb/app.py` 文件中，存在使用来自环境变量（env）、请求头（reqheader）或某些属性的未经验证数据来调用 `open()` 函数，这可能导致安全风险，比如文件包含攻击（file inclusion attack）。\n\n具体到代码片段：\n\n1. 在 `__application` 函数中，可能需要检查这些环境变量和请求头的数据是否可信，再进行文件操作。\n2. 在将 `env[\'BODY_DATA\']` 设置为 `None` 的地方，如果这个值被恶意修改，可能会间接影响到后续的文件路径。\n3. `env[\'RAW_URI\']` 被赋值为 `PATH_INFO`，如果这个值是由用户输入控制，也应确保它没有包含恶意路径。\n4. 在构建静态资源路径时，使用了 `reqheader[\'RAW_URI\']`，这里同样可能存在未验证的数据注入问题。\n5. 最后，在 `f = open(p, \"rb\")` 这一行，直接使用 `p` 可能会读取到由上述变量拼接的任意路径下的文件，这是不安全的，应该对 `p` 进行适当的校验和过滤，确保只处理预期的、安全的文件路径。\n\n为了修复这个问题，你需要对这些潜在的输入进行严格的验证和处理，例如使用参数化查询、正则表达式过滤或者使用安全的字符串操作函数。同时，确保不会执行任何外部用户的命令，只允许读取预定义的安全目录内的资源。记得更新代码以遵循最小权限原则，避免不必要的文件访问。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (11, 'py/untrusted-data-to-external-api', 'Call to hashlib.md5().update \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to hashlib.md5().update \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":730,\"startColumn\":22,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":730,\"startColumn\":22,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":24,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"[post] ControlFlowNode for env [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for env [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":730,\"startColumn\":22,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":730,\"startColumn\":22,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/common/autoload.py\n行号: 544\n\n漏洞描述:\nCall to hashlib.md5().update \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to hashlib.md5().update \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 730 到 730 ）：\n            ETag=md5(p)\n\n\n代码 kcweb/common/autoload.py 片段（行 535 到 535 ）：\ndef md5(strs):\n\n\n代码 kcweb/common/autoload.py 片段（行 543 到 543 ）：\n    b = strs.encode(encoding=\'utf-8\')\n\n\n代码 kcweb/common/autoload.py 片段（行 544 到 544 ）：\n    m.update(b)\n\n\n\n-------------------------------', '根据提供的审计提示，存在一个`py/untrusted-data-to-external-api`类型的漏洞。在`kcweb/common/autoload.py`的第544行，代码使用`hashlib.md5()`函数对来自`ControlFlowNode for env`和`ControlFlowNode for Attribute()`的未经验证数据进行更新。这可能导致安全风险，因为MD5哈希虽然常用但不是安全的加密方式，尤其是当处理用户输入或不受信任的数据时。\n\n在`kcweb/app.py`中，这些可能影响安全的部分包括：\n\n1. 在`__application`方法中，`env[\'BODY_DATA\']`可能包含用户输入，应确保在处理前进行适当的验证。\n2. `env[\'RAW_URI\']`也可能包含用户请求路径，同样需要检查并过滤潜在的安全威胁。\n3. 在生成ETag时，`p`变量是基于用户请求构建的，可能包含不安全的URI。\n\n为了修复这个漏洞，建议执行以下操作：\n\n- 对所有可能包含用户输入的数据进行校验和清理，确保去除特殊字符、编码转义或限制可接受的格式。\n- 使用更安全的哈希函数（如SHA-256）替代MD5，特别是当处理敏感信息时。\n- 如果可能，避免直接将用户输入用于计算哈希，而是将其用于生成唯一标识符，而不是存储在数据库中作为加密密钥。\n\n请确保在代码实现中遵循最佳实践，以防止此类攻击。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (12, 'py/untrusted-data-to-external-api', 'Call to django.db.connection.cursor().execute \\[position 0\\] with untrusted data from [ControlFlowNode for username](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":8,\"startColumn\":24,\"endColumn\":78}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":5,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":8,\"startColumn\":24,\"endColumn\":78}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/sql_injection.py\n行号: 8\n\n漏洞描述:\nCall to django.db.connection.cursor().execute \\[position 0\\] with untrusted data from [ControlFlowNode for username](1).\n\n漏洞代码片段:\n代码 kcweb/sql_injection.py 片段（行 5 到 5 ）：\ndef show_user(request, username):\n\n\n代码 kcweb/sql_injection.py 片段（行 8 到 8 ）：\n        cursor.execute(\"SELECT * FROM users WHERE username = \'%s\'\" % username)\n\n\n\n-------------------------------', '根据提供的审计提示，这是一个SQL注入漏洞。在`kcweb/sql_injection.py`文件的`show_user`函数中，代码使用了字符串格式化来构造SQL查询，其中`username`参数没有经过适当的输入验证就直接被包含在了SQL语句中。这可能导致攻击者通过传递恶意数据来修改、获取或执行数据库中的敏感信息。\n\n为了修复这个漏洞，你应该遵循以下最佳实践：\n\n1. 使用参数化查询（parametrized queries）：这样可以防止SQL注入，因为参数会被数据库引擎正确处理，不会作为SQL的一部分执行。在Django中，可以使用`cursor.execute()`的占位符语法，如下所示：\n\n```python\ncursor.execute(\"SELECT * FROM users WHERE username = %s\", (username,))\n```\n或者使用ORM（Object-Relational Mapper）方法，如`User.objects.get(username=username)`。\n\n2. 对用户输入进行验证和清理：即使使用了参数化查询，也应该对用户输入进行适当的验证，确保它符合预期的格式。例如，检查用户名是否只包含允许的字符，并且长度不超过限制。\n\n3. 错误处理和日志记录：对任何异常或错误进行记录，以便追踪可能的攻击尝试。\n\n4. 更新依赖库和安全配置：保持你的Django和其他依赖库版本更新，以获取最新的安全修复。\n\n请确保在实际代码中应用这些修复措施以提高应用程序的安全性。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (13, 'py/untrusted-data-to-external-api', 'Call to django.db.connection.cursor().execute \\[position 1\\] with untrusted data from [ControlFlowNode for username](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":12,\"startColumn\":67,\"endColumn\":75}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":5,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":12,\"startColumn\":67,\"endColumn\":75}},\"message\":{\"text\":\"ControlFlowNode for username\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/sql_injection.py\n行号: 12\n\n漏洞描述:\nCall to django.db.connection.cursor().execute \\[position 1\\] with untrusted data from [ControlFlowNode for username](1).\n\n漏洞代码片段:\n代码 kcweb/sql_injection.py 片段（行 5 到 5 ）：\ndef show_user(request, username):\n\n\n代码 kcweb/sql_injection.py 片段（行 12 到 12 ）：\n        cursor.execute(\"SELECT * FROM users WHERE username = %s\", username)\n\n\n\n-------------------------------', '根据提供的审计提示，这是一个SQL注入漏洞（py/untrusted-data-to-external-api），发生在`kcweb/sql_injection.py`文件的第12行。问题出在使用用户提交的未经验证的数据`username`直接构造SQL查询。这种做法可能导致恶意用户通过输入特殊字符来改变或绕过数据库查询逻辑。\n\n为了修复这个漏洞，你应该使用参数化查询或者ORM（对象关系映射）来处理用户输入。这样可以防止SQL注入攻击。这里是修复后的代码片段：\n\n```python\nfrom django.db import connection\n\ndef show_user(request, username):\n    # 使用参数化查询\n    cursor = connection.cursor()\n    cursor.execute(\"SELECT * FROM users WHERE username = %s\", (username,))\n    # 或者使用ORM，如果你使用的是Django ORM\n    # user = User.objects.get(username=username)\n    # 不要直接将username作为字符串传递给SQL语句\n```\n\n通过这种方式，即使用户输入包含特殊字符，数据库也会正确解析它们，而不是将它们视为SQL指令的一部分。记得始终验证和清理用户输入，以确保应用程序的安全性。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (14, 'py/untrusted-data-to-external-api', 'Call to django.db.connection.cursor().execute \\[position 1\\] with untrusted data from [ControlFlowNode for username](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":16,\"startColumn\":69,\"endColumn\":77}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":5,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":16,\"startColumn\":69,\"endColumn\":77}},\"message\":{\"text\":\"ControlFlowNode for username\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/sql_injection.py\n行号: 16\n\n漏洞描述:\nCall to django.db.connection.cursor().execute \\[position 1\\] with untrusted data from [ControlFlowNode for username](1).\n\n漏洞代码片段:\n代码 kcweb/sql_injection.py 片段（行 5 到 5 ）：\ndef show_user(request, username):\n\n\n代码 kcweb/sql_injection.py 片段（行 16 到 16 ）：\n        cursor.execute(\"SELECT * FROM users WHERE username = \'%s\'\", username)\n\n\n\n-------------------------------', '根据提供的审计提示，这是一个SQL注入漏洞（py/untrusted-data-to-external-api），发生在`kcweb/sql_injection.py`文件的第16行。在这个Python代码片段中，函数`show_user`试图从数据库中获取用户信息，使用了`username`参数直接拼接到SQL查询字符串中：\n\n```python\ncursor.execute(\"SELECT * FROM users WHERE username = \'%s\'\", username)\n```\n\n问题在于，`username`可能包含用户输入，如果没有正确过滤或转义，恶意用户可能会利用这个漏洞提交SQL命令，导致数据泄露、权限提升或其他安全风险。\n\n为了修复这个漏洞，你应该遵循安全的SQL查询原则，例如使用参数化查询或者ORM（对象关系映射）来避免字符串直插。这可以防止恶意输入被解释为SQL语法的一部分。这里是修复后的片段示例：\n\n```python\nfrom django.db import connection\n\ndef show_user(request, username):\n    cursor = connection.cursor()\n    cursor.execute(\"SELECT * FROM users WHERE username = %s\", (username,))\n    # 或者使用 ORM:\n    # user = User.objects.get(username=username)\n```\n\n确保在处理用户输入时始终使用参数化查询或预编译语句，以防止SQL注入攻击。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (15, 'py/untrusted-data-to-external-api', 'Call to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/untrusted-data-to-external-api\n文件路径: kcweb/utill/filetype/utils.py\n行号: 17\n\n漏洞描述:\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for env](1).\nCall to open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\nCall to builtins.open \\[position 0\\] with untrusted data from [ControlFlowNode for Attribute()](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 738 到 738 ）：\n                kind = filetype.guess(p)\n\n\n代码 kcweb/utill/filetype/filetype.py 片段（行 12 到 12 ）：\ndef guess(obj):\n\n\n代码 kcweb/utill/filetype/filetype.py 片段（行 28 到 28 ）：\n    return match(obj) if obj else None\n\n\n代码 kcweb/utill/filetype/match.py 片段（行 14 到 14 ）：\ndef match(obj, matchers=TYPES):\n\n\n代码 kcweb/utill/filetype/match.py 片段（行 28 到 28 ）：\n    buf = get_bytes(obj)\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 38 到 38 ）：\ndef get_bytes(obj):\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 64 到 64 ）：\n        return get_signature_bytes(obj)\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 6 到 6 ）：\ndef get_signature_bytes(path):\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 17 到 17 ）：\n    with open(path, \'rb\') as fp:\n\n\n\n-------------------------------', '这段审计提示指出在kcweb应用中存在`py/untrusted-data-to-external-api`类型的漏洞。问题出在`kcweb/utill/filetype/utils.py`文件的第17行，代码尝试打开一个文件（`open(path, \'rb\')`），这里的`path`来自一个不确定来源（`ControlFlowNode for env`和`Attribute()`）。这意味着应用程序可能正在使用未经验证的数据来访问文件系统，这可能导致安全风险，比如文件包含攻击（file inclusion attack）或读取敏感文件。\n\n为了修复这个漏洞，你需要确保对`path`参数进行适当的输入验证和处理，例如只允许从受信任的源获取路径，或者使用安全的方法来解析和操作文件路径。以下是一些可能的修复措施：\n\n1. 对`path`进行严格的格式检查和验证，确保它只包含预期的合法字符。\n2. 使用参数化查询或字符串格式化来避免直接拼接用户输入到文件路径。\n3. 如果`path`是从外部API获取的，确保API提供了安全的接口，或者在内部处理时使用安全策略。\n4. 使用沙箱环境（如OS-level sandboxing）来限制文件操作的范围。\n5. 在`get_signature_bytes`等函数中添加异常处理，防止未经授权的文件访问。\n\n请确保检查整个应用程序的逻辑，以确定所有可能的输入点，并采取适当的预防措施来保护系统的安全性。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (16, 'py/path-injection', 'This path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":24,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"[post] ControlFlowNode for env [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for env [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":728,\"startColumn\":27,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/path-injection\n文件路径: kcweb/app.py\n行号: 728\n\n漏洞描述:\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 728 到 728 ）：\n        if os.path.isfile(p):\n\n\n\n-------------------------------', '你好，根据提供的审计提示，这似乎是一个Python环境中的路径注入（path injection）漏洞。在`kcweb/app.py`的第728行，代码创建了一个文件路径，该路径依赖于用户提供的`RAW_URI`值，这可能导致恶意用户通过输入特殊字符来尝试访问他们不应访问的文件。\n\n为了修复这个漏洞，你需要确保对用户提供的`RAW_URI`进行适当的验证和清理，以防止恶意路径构造。以下是一些建议：\n\n1. **验证和转义输入**：\n   - 对`RAW_URI`进行校验，只允许特定的字符集（例如URL编码的路径或特定的目录结构）。\n   - 使用`urlparse`或类似函数来解析并规范化URL，防止额外的路径元素或特殊字符。\n\n2. **使用参数化查询或模板引擎**：\n   - 如果可能，使用参数化查询来构建动态路径，而不是直接拼接字符串。\n\n3. **使用安全的文件系统操作**：\n   - 使用`os.path.join`代替字符串拼接，这样可以避免路径解析问题。\n\n4. **设置文件访问权限**：\n   - 确保服务器不会执行任何不受信任的文件，即使路径看起来正确。\n\n5. **错误处理和日志记录**：\n   - 对无效的路径请求进行适当的错误处理，并记录日志以监控潜在攻击。\n\n请在实际代码中实施这些安全措施，以保护你的应用免受路径注入攻击。如果你需要具体的代码示例，请告诉我。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (17, 'py/path-injection', 'This path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":740,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/path-injection\n文件路径: kcweb/app.py\n行号: 740\n\n漏洞描述:\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 740 到 740 ）：\n                    f=open(p,\"rb\")\n\n\n\n-------------------------------', '你好，根据提供的审计提示，存在一个 `py/path-injection` 类型的漏洞。这个漏洞出现在 `kcweb/app.py` 文件中，具体在第740行。问题在于，`f.open(p, \"rb\")` 这一行代码中的 `p` 变量是基于用户提供的值动态构建的文件路径，这可能导致恶意用户通过输入恶意路径来访问或执行他们不应该访问的文件。\n\n为了修复这个问题，你需要确保对用户提供的值进行适当的验证和转义，以防止路径注入攻击。以下是一些建议：\n\n1. **验证和规范化输入**：\n   - 对 `reqheader[\'RAW_URI\']` 或其他用户输入的部分进行检查，确保只允许安全的字符，并且符合预期的路径格式。\n   - 使用函数如 `os.path.join()` 或 `urlparse.urljoin()` 来构造路径，这些函数会自动处理路径安全问题。\n\n2. **使用参数化查询**：\n   - 如果可能，将文件路径作为参数传递给 `open()` 函数，而不是直接拼接用户提供的字符串。\n\n3. **使用安全的文件操作**：\n   - 使用 `pathlib` 库中的 `Path` 对象，它提供了安全的方法来处理文件路径。\n\n4. **错误处理**：\n   - 如果验证失败或找不到预期的文件，应该返回一个错误响应，而不是直接暴露潜在的安全风险。\n\n请确保在修改代码时遵循以上建议，以增强应用程序的安全性。同时，定期更新你的代码库，保持对已知安全漏洞的防护。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (18, 'py/path-injection', 'This path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":748,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for p\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/path-injection\n文件路径: kcweb/app.py\n行号: 748\n\n漏洞描述:\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 748 到 748 ）：\n                    f=open(p,\"rb\")\n\n\n\n-------------------------------', '看起来你在分析一个Python Web应用程序中的安全问题，具体来说是路径注入（path injection）漏洞。路径注入漏洞发生在程序使用用户输入来构建文件或资源的URL路径时，没有正确验证或编码这些输入，可能导致恶意用户访问不应访问的文件或者执行预谋的操作。\n\n在`kcweb/app.py`中，以下几个部分可能存在问题：\n\n1. 在`__application`函数中，`env[\'PATH_INFO\']`可能包含用户提供的值，这在`env[\'RAW_URI\'] = env[\'PATH_INFO\']`这一行被用作构建原始URI。\n\n2. 在`711-711`行的`reqheader`字典中，`reqheader[\'RAW_URI\']`同样可能包含用户输入。\n\n3. 最后，在`748-748`行的`f = open(p, \"rb\")`中，`p`变量被设置为配置的静态路径加上用户提供的`reqheader[\'RAW_URI\']`，这可能导致攻击者通过输入恶意路径来尝试读取敏感文件。\n\n为了修复这个漏洞，你需要对用户输入进行适当的验证和处理，例如：\n\n- 对`PATH_INFO`、`RAW_URI`等进行参数化查询，使用`urljoin()`或类似函数来构造路径，而不是直接拼接。\n- 使用`os.path.join()`或`safe_join()`来确保路径符合预期格式，避免目录遍历。\n- 使用`str.encode()`或`urllib.parse.quote()`等方法对用户输入进行转义或编码，以防止特殊字符被解析为路径分隔符。\n\n确保始终遵循最小权限原则，只允许访问应用程序预期的资源。同时，定期更新和应用安全最佳实践，以减少潜在的安全风险。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (19, 'py/path-injection', 'This path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":683,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":671,\"startColumn\":28,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":687,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":688,\"startColumn\":9,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for env\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":714,\"startColumn\":23,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":19,\"endLine\":725,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for reqheader [Dictionary element at key RAW_URI]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":37,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":21,\"endColumn\":96}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":678,\"startColumn\":13,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for files\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":711,\"startColumn\":9,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for reqheader\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":726,\"startColumn\":9,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":738,\"startColumn\":39,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for p\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":12,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/filetype.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":5},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":14,\"startColumn\":11,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/match.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":6},\"region\":{\"startLine\":28,\"startColumn\":21,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":38,\"startColumn\":15,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":64,\"startColumn\":36,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for obj\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":6,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for path\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/filetype\\/utils.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":4},\"region\":{\"startLine\":17,\"startColumn\":15,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for path\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/path-injection\n文件路径: kcweb/utill/filetype/utils.py\n行号: 17\n\n漏洞描述:\nThis path depends on a [user-provided value](1).\nThis path depends on a [user-provided value](2).\n\n漏洞代码片段:\n代码 kcweb/app.py 片段（行 671 到 671 ）：\n    def __application(self,env, start_response):\n\n\n代码 kcweb/app.py 片段（行 683 到 683 ）：\n            env[\'BODY_DATA\']=None\n\n\n代码 kcweb/app.py 片段（行 688 到 688 ）：\n        env[\'RAW_URI\']=env[\'PATH_INFO\']\n\n\n代码 kcweb/app.py 片段（行 711 到 711 ）：\n        reqheader={ \n\n\n代码 kcweb/app.py 片段（行 726 到 726 ）：\n        p=(config.app[\'staticpath\']+reqheader[\'RAW_URI\'].replace(\' \',\'\'))\n\n\n代码 kcweb/app.py 片段（行 738 到 738 ）：\n                kind = filetype.guess(p)\n\n\n代码 kcweb/utill/filetype/filetype.py 片段（行 12 到 12 ）：\ndef guess(obj):\n\n\n代码 kcweb/utill/filetype/filetype.py 片段（行 28 到 28 ）：\n    return match(obj) if obj else None\n\n\n代码 kcweb/utill/filetype/match.py 片段（行 14 到 14 ）：\ndef match(obj, matchers=TYPES):\n\n\n代码 kcweb/utill/filetype/match.py 片段（行 28 到 28 ）：\n    buf = get_bytes(obj)\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 38 到 38 ）：\ndef get_bytes(obj):\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 64 到 64 ）：\n        return get_signature_bytes(obj)\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 6 到 6 ）：\ndef get_signature_bytes(path):\n\n\n代码 kcweb/utill/filetype/utils.py 片段（行 17 到 17 ）：\n    with open(path, \'rb\') as fp:\n\n\n\n-------------------------------', '根据提供的审计提示，存在一个`path-injection`漏洞。这个漏洞出现在kcweb应用中的`utils.py`文件中，具体在`get_signature_bytes`函数的第17行。这个函数使用用户提供的值来打开一个文件，如果该值被恶意注入，可能会导致攻击者读取、修改或执行他们选择的任意文件。\n\n为了修复这个漏洞，你需要采取以下措施：\n\n1. **验证和过滤输入**：对用户提供的`path`参数进行严格的验证和转义，确保它只包含预期的字符，不包含任何可能导致路径解析错误的特殊字符，如`..`或路径分隔符。\n\n2. **使用参数化查询或安全的文件操作**：如果你的应用支持，可以使用参数化查询来构造文件路径，或者使用更安全的方法来处理用户输入，比如使用`os.path.join()`函数而不是字符串拼接。\n\n3. **限制文件访问权限**：确保应用程序运行时没有不必要的文件系统权限，仅允许访问应用程序需要的文件。\n\n4. **异常处理和日志记录**：在尝试打开文件时，添加适当的异常处理和日志记录，以便在发生异常时捕获并报告潜在的恶意行为。\n\n5. **代码审查和重构**：对整个文件类型处理逻辑进行审查，看看是否有其他地方可能受到类似漏洞的影响，并进行相应的改进。\n\n记得在修复后重新测试以确认漏洞已经被妥善解决。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (20, 'py/tarslip', 'This file extraction depends on a [potentially untrusted source](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":696,\"startColumn\":13,\"endColumn\":14}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":695,\"startColumn\":17,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":695,\"startColumn\":13,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for t\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":696,\"startColumn\":13,\"endColumn\":14}},\"message\":{\"text\":\"ControlFlowNode for t\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/tarslip\n文件路径: kcweb/common/autoload.py\n行号: 696\n\n漏洞描述:\nThis file extraction depends on a [potentially untrusted source](1).\n\n漏洞代码片段:\n代码 kcweb/common/autoload.py 片段（行 695 到 695 ）：\n            t = tarfile.open(dst)\n\n\n代码 kcweb/common/autoload.py 片段（行 695 到 695 ）：\n            t = tarfile.open(dst)\n\n\n代码 kcweb/common/autoload.py 片段（行 696 到 696 ）：\n            t.extractall(path = src)\n\n\n\n-------------------------------', '根据提供的审计提示，这似乎是一个关于`py/tarslip`漏洞的警告。在`kcweb/common/autoload.py`文件中，第695-696行的代码可能涉及使用`tarfile.open`来解压一个tar文件。问题在于，`dst`变量可能是用户输入或来自不可信来源的数据，这可能导致安全风险，比如恶意文件注入（如包含恶意脚本的文件被错误地提取到目标目录`src`）。\n\n为了修复这个漏洞，你应该确保：\n\n1. 对`dst`进行适当的验证和清理，以防止包含不受信任的路径或文件名。\n2. 使用安全的方法来构建`path`参数，例如使用参数化查询、模板引擎的模板字符串，或者对用户输入进行转义处理。\n3. 如果可能，使用安全的函数或库来处理tar文件，如使用`tarfile.TarFile.extractall`的`filter`参数来限制提取内容。\n\n请检查并更新你的代码以遵循最佳实践，以避免潜在的安全漏洞。如果使用的是框架，请查阅其官方文档或安全指南，了解是否有专门的安全建议。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (21, 'py/sql-injection', 'This SQL query depends on a [user-provided value](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":8,\"startColumn\":24,\"endColumn\":78}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":5,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/sql_injection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":3},\"region\":{\"startLine\":8,\"startColumn\":24,\"endColumn\":78}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/sql-injection\n文件路径: kcweb/sql_injection.py\n行号: 8\n\n漏洞描述:\nThis SQL query depends on a [user-provided value](1).\n\n漏洞代码片段:\n代码 kcweb/sql_injection.py 片段（行 5 到 5 ）：\ndef show_user(request, username):\n\n\n代码 kcweb/sql_injection.py 片段（行 8 到 8 ）：\n        cursor.execute(\"SELECT * FROM users WHERE username = \'%s\'\" % username)\n\n\n\n-------------------------------', '根据提供的审计提示，存在一个SQL注入漏洞（py/sql-injection）在`kcweb/sql_injection.py`文件中。问题出在第8行的SQL查询语句：\n\n```python\ncursor.execute(\"SELECT * FROM users WHERE username = \'%s\'\" % username)\n```\n\n这里使用了字符串格式化来插入用户提供的`username`值，这可能导致SQL注入攻击。攻击者可能会输入恶意的SQL代码，尝试绕过权限或获取敏感信息。为防止这种情况，应使用参数化查询或者使用ORM（对象关系映射）库，如SQLAlchemy，以确保用户输入被安全地转义。\n\n修复建议：\n\n1. 使用参数化查询（参数化SQL或预编译语句）：\n```python\ncursor.execute(\"SELECT * FROM users WHERE username = ?\", (username,))\n```\n2. 如果使用的是ORM框架，例如SQLAlchemy，可以这样操作：\n```python\nquery = User.query.filter_by(username=username)\ncursor.execute(query.statement, query.parameters)\n```\n3. 使用ORM的`query.filter()`方法，避免直接拼接SQL字符串。\n\n请务必更新您的代码以应用这些安全措施。', '2024-06-16 14:36:57');
INSERT INTO `codeql` VALUES (22, 'py/request-without-cert-validation', 'This request may run without certificate validation because [it is disabled](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1092,\"startColumn\":27,\"endColumn\":67}}}]', '[]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/request-without-cert-validation\n文件路径: kcweb/common/autoload.py\n行号: 1092\n\n漏洞描述:\nThis request may run without certificate validation because [it is disabled](1).\n\n漏洞代码片段:\n                        r=requests.get(arr[\'dowurl\'],verify=False)\n\n-------------------------------', '您提供的审计提示表明存在一个安全漏洞，名为 \"py/request-without-cert-validation\"。这个漏洞出现在 `kcweb/common/autoload.py` 文件的第 1092 行。问题在于，使用了 `requests.get()` 方法时，`verify=False` 参数被设置为 `False`，这意味着在进行HTTPS请求时，没有对服务器的SSL证书进行验证。\n\n这可能会导致以下风险：\n1. **不安全连接**：如果服务器的SSL证书有问题（例如，过期、伪造或不受信任），未验证连接可能导致敏感信息被中间人攻击截取。\n2. **身份伪造**：攻击者可以利用无效或伪造的证书来冒充合法网站，欺骗用户或系统。\n\n修复建议：\n- **启用证书验证**：为了确保通信的安全性，应该始终启用证书验证，即使是在开发环境中，也可以使用自签名证书或者可信的CA签发的证书。\n- **证书例外处理**：如果确实需要在某些情况下禁用验证，应仅限于明确且经过严格评估的情况，并记录这些异常情况。\n- **代码审查和更新**：审查这段代码，确认是否有特定场景需要临时禁用验证，并在必要时添加适当的注释或条件检查。\n\n修改后的代码片段可能如下所示：\n```python\ntry:\n    r = requests.get(arr[\'dowurl\'], verify=True, timeout=your_timeout_value)\nexcept requests.exceptions.SSLError:\n    # 在这里记录并处理证书验证失败的情况\n    log.warning(\"Certificate validation failed for URL: %s\", arr[\'dowurl\'])\n    r = requests.get(arr[\'dowurl\'], verify=False, timeout=your_timeout_value)  # 如果有特殊需求，这里只在处理特定异常时禁用验证\n```\n请务必根据实际项目需求和安全策略来调整上述代码。', '2024-06-16 14:37:06');
INSERT INTO `codeql` VALUES (23, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":773,\"startColumn\":19,\"endColumn\":74}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":178,\"startColumn\":34,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":96,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":122,\"startColumn\":38,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":161,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":189,\"startColumn\":22,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":766,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":773,\"startColumn\":19,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":178,\"startColumn\":34,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":96,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":122,\"startColumn\":38,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":161,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":189,\"startColumn\":22,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":766,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":773,\"startColumn\":19,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":178,\"startColumn\":34,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":96,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":122,\"startColumn\":38,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":161,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":189,\"startColumn\":22,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":766,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":773,\"startColumn\":19,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":178,\"startColumn\":34,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":96,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":122,\"startColumn\":38,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":161,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":189,\"startColumn\":22,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":766,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for host\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/app.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":0},\"region\":{\"startLine\":773,\"startColumn\":19,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/app.py\n行号: 773\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 178 到 178 ）：\n                    app.run(host=cmd_par[\'host\'],port=int(cmd_par[\'port\']))\n\n\n代码 kcweb/app.py 片段（行 96 到 96 ）：\n    def run(self,host=\"127.0.0.1\",port=\"39001\",name=None):\n\n\n代码 kcweb/app.py 片段（行 122 到 122 ）：\n                    self.__impl(host=host,port=port,filename=filename)\n\n\n代码 kcweb/app.py 片段（行 161 到 161 ）：\n    def __impl(self,host,port,filename):\n\n\n代码 kcweb/app.py 片段（行 189 到 189 ）：\n                host=host,\n\n\n代码 kcweb/app.py 片段（行 766 到 766 ）：\n    def __http_wsgi(self,host,port,filename):\n\n\n代码 kcweb/app.py 片段（行 773 到 773 ）：\n            print(\"\\033[32m* 运行在http://\"+host+\":\"+str(port)+\"（按CTRL+C退出）\")\n\n\n\n-------------------------------', '根据提供的审计提示，您在 `kcweb/app.py` 文件的第 773 行存在一个潜在的安全漏洞。这个漏洞类型是 `py/clear-text-logging-sensitive-data`，意味着您的代码正在以明文形式存储或日志敏感数据（密码），这可能会导致数据泄露。\n\n具体来看，这段代码可能在用户界面或者日志输出中直接显示了用户的密码，这是不安全的做法。为了修复这个问题，您应该：\n\n1. 不要在返回的数据结构中直接包含密码，尤其是当它作为输出返回给用户时。可以考虑使用哈希或加密技术处理密码，并在需要验证时进行解密。\n\n2. 如果密码是用于配置目的，如运行时参数，那么应该将其安全地存储，例如使用环境变量、秘钥管理服务，或者在运行时通过安全的方式提供给应用程序。\n\n3. 对于日志记录，如果必须包含密码，确保采用安全的日志处理方式，比如对密码进行脱敏（替换为星号或其他符号）。\n\n4. 如果是在调试或测试环境中，确保只在严格限制的环境下显示或处理敏感信息，且在生产环境中移除或替换这些内容。\n\n请检查并更新相关代码，确保遵循安全最佳实践来保护用户的敏感信息。', '2024-06-16 14:37:12');
INSERT INTO `codeql` VALUES (24, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":966,\"startColumn\":23,\"endColumn\":58}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":81,\"endColumn\":99}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":51,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for project\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":966,\"startColumn\":23,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":199,\"startColumn\":81,\"endColumn\":99}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":51,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for project\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":966,\"startColumn\":23,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":81,\"endColumn\":99}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":51,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for project\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":966,\"startColumn\":23,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":199,\"startColumn\":81,\"endColumn\":99}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":51,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for project\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":966,\"startColumn\":23,\"endColumn\":58}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 966\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 966 到 966 ）：\n                print(\'项目已存在，请进入\'+str(project)+\'目录命令执行命令\')\n\n\n\n-------------------------------', '您好，根据您提供的审计提示，我发现了一个潜在的安全漏洞。在kcweb/kcweb.py和kcweb/common/autoload.py文件中，存在明文存储敏感数据（密码）的情况。以下是具体问题：\n\n1. 在`kcweb/kcweb.py`的代码片段中，有两个位置直接将`password`变量作为输出或用于后续操作，如：\n   - `return {\'password\': password, ...}`\n   - `server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])`\n   这意味着密码可能在日志或者进一步的交互中被暴露。\n\n2. 在`kcweb/common/autoload.py`的`__init__`方法中，密码也可能出现在打印语句中，虽然没有直接返回，但作为字符串输出可能会被记录：\n   - `print(\'项目已存在，请进入\'+str(project)+\'目录命令执行命令\')`\n\n为了修复这个漏洞，建议采取以下措施：\n\n- 不要在返回的数据结构中直接包含明文密码。可以考虑使用哈希或加密技术对密码进行处理，然后在需要时解密。\n- 对敏感信息进行脱敏处理，例如使用星号(*)代替密码的一部分或全部。\n- 将密码存储在安全的地方，比如数据库，而不是硬编码在代码中。在需要时通过查询数据库获取。\n\n请尽快检查并修复这些代码中的安全问题，以防止敏感数据泄露。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (25, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1015,\"startColumn\":27,\"endColumn\":40}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":26,\"endColumn\":131}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1015,\"startColumn\":27,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1015,\"startColumn\":27,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":26,\"endColumn\":131}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1015,\"startColumn\":27,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1015,\"startColumn\":27,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1015\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 216 到 216 ）：\n                            res=server.uploadplug(cmd_par[\'plug\'],cmd_par[\'username\'],cmd_par[\'password\'],cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 997 到 997 ）：\n    def uploadplug(self,plug,username=\'\',password=\'\',cli=False):\n\n\n代码 kcweb/common/autoload.py 片段（行 1010 到 1010 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/userinfo/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign)\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/utill/http.py 片段（行 55 到 55 ）：\n        response=self.req.request(method, url,data=data,params=params,json=jsonparams,files=files,proxies=self.set_proxies,cookies=self.set_cookies,headers=self.set_header,timeout=self.set_timeout,verify=self.set_verify,allow_redirects=allow_redirects)\n\n\n代码 kcweb/utill/http.py 片段（行 56 到 56 ）：\n        response.encoding=self.set_encoding\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/common/autoload.py 片段（行 1010 到 1010 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/userinfo/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign)\n\n\n代码 kcweb/common/autoload.py 片段（行 1015 到 1015 ）：\n                    print(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1015 到 1015 ）：\n                    print(http.get_text)\n\n\n\n-------------------------------', '您好，根据提供的审计提示，存在 `py/clear-text-logging-sensitive-data` 类型的漏洞。在 `kcweb/common/autoload.py` 文件的第 1015 行，代码中似乎在打印一个 HTTP 请求的响应文本（`http.get_text`），其中可能包含了敏感数据（密码），即以明文形式被记录或输出。\n\n为了修复这个漏洞，你需要确保密码等敏感信息在传输和处理过程中是加密的或者不直接暴露给日志。以下是一些建议：\n\n1. **加密**：在发送敏感数据之前对其进行加密，如使用HTTPS协议，或者在服务端对密码进行哈希存储。\n2. **脱敏**：在日志记录时，将密码替换为星号或其他表示符，而不是实际的密码值。\n3. **控制输出**：仅在调试模式下才打印敏感信息，而在生产环境中移除或替换这些打印语句。\n4. **日志策略**：遵循最小权限原则，只记录必要的信息，并且确保日志系统不会保存明文敏感数据。\n\n请检查这些代码片段，看看是否可以采取措施来保护密码的隐私。同时，确保在整个应用的生命周期内实施相应的安全措施，以防止数据泄露。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (26, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":36}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":26,\"endColumn\":131}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1034,\"startColumn\":22,\"endColumn\":129}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1034,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":26,\"endColumn\":131}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1034,\"startColumn\":22,\"endColumn\":129}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1034,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1041,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1041\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 216 到 216 ）：\n                            res=server.uploadplug(cmd_par[\'plug\'],cmd_par[\'username\'],cmd_par[\'password\'],cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 997 到 997 ）：\n    def uploadplug(self,plug,username=\'\',password=\'\',cli=False):\n\n\n代码 kcweb/common/autoload.py 片段（行 1010 到 1010 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/userinfo/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign)\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/utill/http.py 片段（行 55 到 55 ）：\n        response=self.req.request(method, url,data=data,params=params,json=jsonparams,files=files,proxies=self.set_proxies,cookies=self.set_cookies,headers=self.set_header,timeout=self.set_timeout,verify=self.set_verify,allow_redirects=allow_redirects)\n\n\n代码 kcweb/utill/http.py 片段（行 56 到 56 ）：\n        response.encoding=self.set_encoding\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/common/autoload.py 片段（行 1010 到 1010 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/userinfo/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign)\n\n\n代码 kcweb/common/autoload.py 片段（行 1041 到 1041 ）：\n                print(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1041 到 1041 ）：\n                print(http.get_text)\n\n\n\n-------------------------------', '您好，根据您提供的审计提示，存在 `py/clear-text-logging-sensitive-data` 类型的漏洞。在 `kcweb/common/autoload.py` 文件的第 1041 行，代码中有对用户密码的明文打印。这可能会导致敏感信息泄露，因为密码不应该以明文形式出现在日志或输出中。\n\n具体到 `kcweb/kcweb.py` 中的代码片段：\n\n```python\n# 确保使用安全的方式处理和存储密码，不要直接暴露在print语句中\nreturn {\n    # ...\n    \'password\': password,  # 这里应使用安全的方法（如哈希或脱敏）处理密码\n    # ...\n}\n\ncmd_par = __get_cmd_par()\nres = server.uploadplug(cmd_par[\'plug\'], cmd_par[\'username\'], cmd_par[\'password\'], cli=True)\n\n# 在uploadplug函数中，同样需要确保password参数安全处理，而不是直接打印\ndef uploadplug(self, plug, username=\'\', password=\'\', cli=False):\n    # ...\n\n# 在http.openurl方法中，传递给API的密码也应进行适当的加密或混淆\nhttp.openurl(config.domain[\'kcwebapi\'] + \"/user/userinfo/?username=\" + username + \"&timestamp=\" + str(timestamp) + \"&sign=\" + sign)\n```\n\n请检查这些部分，并确保在处理用户密码时采用安全措施，例如使用加密、哈希或脱敏技术，避免直接存储或显示明文密码。同时，确保其他涉及敏感数据的部分也有相应的保护措施。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (27, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1213,\"startColumn\":27,\"endColumn\":40}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":26,\"endColumn\":136}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1213,\"startColumn\":27,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1213,\"startColumn\":27,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":26,\"endColumn\":136}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1213,\"startColumn\":27,\"endColumn\":31}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1213,\"startColumn\":27,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1213\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 223 到 223 ）：\n                            res=server.uploadmodular(cmd_par[\'username\'],cmd_par[\'password\'],cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1193 到 1193 ）：\n    def uploadmodular(self,username=\'\',password=\'\',cli=False):\n\n\n代码 kcweb/common/autoload.py 片段（行 1206 到 1206 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/uploadmodular/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign,\'POST\',\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/utill/http.py 片段（行 55 到 55 ）：\n        response=self.req.request(method, url,data=data,params=params,json=jsonparams,files=files,proxies=self.set_proxies,cookies=self.set_cookies,headers=self.set_header,timeout=self.set_timeout,verify=self.set_verify,allow_redirects=allow_redirects)\n\n\n代码 kcweb/utill/http.py 片段（行 56 到 56 ）：\n        response.encoding=self.set_encoding\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/common/autoload.py 片段（行 1206 到 1206 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/uploadmodular/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign,\'POST\',\n\n\n代码 kcweb/common/autoload.py 片段（行 1213 到 1213 ）：\n                    print(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1213 到 1213 ）：\n                    print(http.get_text)\n\n\n\n-------------------------------', '您好，根据您提供的审计提示，存在 `py/clear-text-logging-sensitive-data` 类型的漏洞。在 `kcweb/common/autoload.py` 文件的第 1213 行，代码中似乎直接打印了从 `http.get_text` 获取的内容，其中包含了敏感数据（密码），这可能导致密码以明文形式暴露在日志中，增加了安全风险。\n\n为了修复这个漏洞，你应该避免在日志中直接打印敏感信息，特别是密码。以下是可能的修复建议：\n\n1. **替换为脱敏处理**：将密码或者其他敏感数据在输出时进行脱敏，例如使用星号(*)替换或使用哈希算法加密后再打印。\n2. **使用日志记录器**：使用专业的日志记录库（如Python的`logging`模块）并设置合适的日志级别（如DEBUG、INFO、WARNING等），只记录必要的信息到日志，而不会显示敏感数据。\n3. **过滤敏感信息**：在打印前检查日志内容，如果包含敏感信息，则不进行打印。\n\n请根据你的项目需求和安全策略来选择最合适的修复方法。记得在开发完成后，确保对代码进行彻底的审查和测试，以确保漏洞已经被正确修复。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (28, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":36}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":26,\"endColumn\":136}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1236,\"startColumn\":22,\"endColumn\":132}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1236,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":26,\"endColumn\":136}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1236,\"startColumn\":22,\"endColumn\":132}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1236,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1243,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1243\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 223 到 223 ）：\n                            res=server.uploadmodular(cmd_par[\'username\'],cmd_par[\'password\'],cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1193 到 1193 ）：\n    def uploadmodular(self,username=\'\',password=\'\',cli=False):\n\n\n代码 kcweb/common/autoload.py 片段（行 1206 到 1206 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/uploadmodular/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign,\'POST\',\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/utill/http.py 片段（行 55 到 55 ）：\n        response=self.req.request(method, url,data=data,params=params,json=jsonparams,files=files,proxies=self.set_proxies,cookies=self.set_cookies,headers=self.set_header,timeout=self.set_timeout,verify=self.set_verify,allow_redirects=allow_redirects)\n\n\n代码 kcweb/utill/http.py 片段（行 56 到 56 ）：\n        response.encoding=self.set_encoding\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/common/autoload.py 片段（行 1206 到 1206 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/uploadmodular/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign,\'POST\',\n\n\n代码 kcweb/common/autoload.py 片段（行 1243 到 1243 ）：\n                print(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1243 到 1243 ）：\n                print(http.get_text)\n\n\n\n-------------------------------', '您好，根据您提供的审计提示，存在 `py/clear-text-logging-sensitive-data` 类型的漏洞。在 `kcweb/common/autoload.py` 文件的第 1243 行，代码可能在明文形式下打印了一个包含敏感数据（密码）的信息。这可能会导致安全风险，因为密码不应以明文形式出现在日志或输出中。\n\n为修复这个问题，您需要确保密码在存储、处理或传输时都进行加密或脱敏。以下是一些建议：\n\n1. **加密密码**：在存储或发送密码时，使用安全的哈希函数（如 bcrypt 或 Argon2）对其进行加密。\n2. **参数化查询**：在 HTTP 请求中，将敏感参数（如密码）作为参数而不是直接拼接在 URL 中，防止 SQL 注入攻击。\n3. **日志安全**：如果必须在日志中提及密码，请使用安全的方式，例如哈希值或脱敏字符串。\n4. **错误处理**：对于调试目的，可以使用更安全的日志级别，只在调试模式下显示敏感信息，并确保在生产环境中这些信息被正确过滤。\n\n请检查 `kcweb/kcweb.py` 和相关模块中的代码，确保对敏感数据的处理符合最佳实践，特别是涉及到密码的部分。同时，更新第 1243 行的 `print(http.get_text)` 语句，如果不需要明文显示，可以移除或者替换为适当的脱敏方法。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (29, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":186,\"startColumn\":31,\"endColumn\":34}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":48,\"endColumn\":63}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1060,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1075,\"startColumn\":36,\"endColumn\":56}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":102}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":25,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":186,\"startColumn\":31,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1106,\"startColumn\":34,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1106,\"startColumn\":34,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1106,\"startColumn\":28,\"endColumn\":70}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":102}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":25,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":186,\"startColumn\":31,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":48,\"endColumn\":63}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1060,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1075,\"startColumn\":36,\"endColumn\":56}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":102}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":25,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":186,\"startColumn\":31,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1106,\"startColumn\":34,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1106,\"startColumn\":34,\"endColumn\":46}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1106,\"startColumn\":28,\"endColumn\":70}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":102}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":25,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":186,\"startColumn\":31,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/kcweb.py\n行号: 186\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 185 到 185 ）：\n                        res=server.installplug(cmd_par[\'plug\'],cli=True,username=cmd_par[\'username\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 1055 到 1055 ）：\n    def installplug(self,plug,edition=\'\',token=\'\',cli=False,mandatory=False,username=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1060 到 1060 ）：\n        plug=str(plug)\n\n\n代码 kcweb/common/autoload.py 片段（行 1075 到 1075 ）：\n                            return False,plug+\"插件授权码错误\"\n\n\n代码 kcweb/kcweb.py 片段（行 185 到 185 ）：\n                        res=server.installplug(cmd_par[\'plug\'],cli=True,username=cmd_par[\'username\'])\n\n\n代码 kcweb/kcweb.py 片段（行 185 到 185 ）：\n                        res=server.installplug(cmd_par[\'plug\'],cli=True,username=cmd_par[\'username\'])\n\n\n代码 kcweb/kcweb.py 片段（行 186 到 186 ）：\n                        print(res)\n\n\n\n-------------------------------', '根据提供的审计提示，您在 `kcweb.py` 文件中发现了潜在的安全漏洞，类型为 `py/clear-text-logging-sensitive-data`。具体来说，存在敏感数据（密码）以明文形式被打印（`print(res)`），这可能会暴露给未经授权的用户。以下是修复建议：\n\n1. **加密敏感数据**：在存储或传输密码时，务必使用安全的方法进行加密，如哈希和盐值处理。这样即使数据被截获，也无法直接读取原始密码。\n\n2. **不直接输出**：移除或修改 `print(res)` 这一行，确保密码不会被明文显示。如果需要日志记录，可以考虑使用安全的日志记录库，并对敏感信息进行脱敏处理。\n\n3. **参数传递**：在调用 `server.installplug` 方法时，传递一个经过处理的参数对象，而不是直接使用包含密码的字典。这样可以避免直接暴露密码。\n\n4. **代码审查**：检查 `__get_cmd_par()` 函数，确保它没有意外地返回明文密码。\n\n5. **增强代码安全性**：在 `autoload.py` 中，当处理插件安装时，使用更严格的验证逻辑，比如检查插件授权码、加密的版本信息等，减少直接暴露敏感信息的机会。\n\n6. **更新安全策略**：遵循最佳实践，如使用HTTPS来保护数据传输，限制不必要的日志级别，以及定期审查代码中的安全措施。\n\n请确保在修复后进行全面的测试，包括边缘情况和可能的攻击场景，以确保安全性的提升。', '2024-06-16 14:37:19');
INSERT INTO `codeql` VALUES (30, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":193,\"startColumn\":35,\"endColumn\":36}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1326,\"startColumn\":30,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1326,\"startColumn\":30,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1326,\"startColumn\":24,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":21,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for t\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":193,\"startColumn\":35,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for t\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1328,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1328,\"startColumn\":56,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1328,\"startColumn\":20,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":21,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for t\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":193,\"startColumn\":35,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for t\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1326,\"startColumn\":30,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1326,\"startColumn\":30,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1326,\"startColumn\":24,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":21,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for t\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":193,\"startColumn\":35,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for t\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1328,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1328,\"startColumn\":56,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1328,\"startColumn\":20,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":21,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for t\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":193,\"startColumn\":35,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for t\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/kcweb.py\n行号: 193\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1254 到 1254 ）：\n    def installmodular(self,token=\'\',cli=False,package=\'kcweb\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1326 到 1326 ）：\n                return False,self.appname+\"不是kcweb应用\"\n\n\n代码 kcweb/common/autoload.py 片段（行 1326 到 1326 ）：\n                return False,self.appname+\"不是kcweb应用\"\n\n\n代码 kcweb/common/autoload.py 片段（行 1326 到 1326 ）：\n                return False,self.appname+\"不是kcweb应用\"\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/kcweb.py 片段（行 193 到 193 ）：\n                            print(t)\n\n\n\n-------------------------------', '看起来你提供的是一份Python项目中的审计报告，指出存在`py/clear-text-logging-sensitive-data`类型的漏洞。具体来说，代码中涉及到用户的密码作为明文被直接打印到控制台，这显然是不安全的，因为明文密码一旦被日志记录或抓取，就可能暴露给未经授权的用户。\n\n为了修复这个漏洞，你需要确保密码在传输或存储时是加密的。以下是一些可能的修复建议：\n\n1. **密码加密**：在将密码传递给需要保存或显示的地方之前，使用一个安全的加密算法（如bcrypt、argon2等）对其进行加密。\n\n2. **环境变量或配置**：如果密码存储在代码中，考虑将其替换为环境变量或配置文件中的值，这样可以避免直接暴露在源码中。\n\n3. **日志处理**：对敏感信息进行脱敏处理，例如使用`*`或者其他占位符代替实际密码，只在日志中记录加密后的密文或哈希值。\n\n4. **代码重构**：如果密码仅在某些特定情况下需要打印，确保这些操作是在验证了安全性和必要性之后执行的，并且只在内部环境中执行，比如调试环境。\n\n5. **遵循安全最佳实践**：确保你的代码遵循通用的安全编码规范，比如OWASP Top 10指南。\n\n请根据项目的具体情况和安全策略来调整修复方法，并在重构代码时更新相关的逻辑和错误处理。记得在部署前进行充分的测试，以确保修复措施的有效性。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (31, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":227,\"startColumn\":27,\"endColumn\":30}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":26,\"endColumn\":131}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":29,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":29,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":552,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":555,\"startColumn\":16,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":17,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for json_decode()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for arr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1033,\"startColumn\":24,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":33,\"endColumn\":116}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":29,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":227,\"startColumn\":27,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":26,\"endColumn\":136}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":29,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":29,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":552,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":555,\"startColumn\":16,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":17,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for json_decode()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for arr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1234,\"startColumn\":24,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":33,\"endColumn\":103}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":29,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":227,\"startColumn\":27,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":67,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":30,\"endColumn\":38}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":26,\"endColumn\":131}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1010,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":29,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":29,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":552,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":555,\"startColumn\":16,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":17,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for json_decode()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1011,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for arr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1033,\"startColumn\":24,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":33,\"endColumn\":116}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":216,\"startColumn\":29,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":227,\"startColumn\":27,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":54,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":28,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":26,\"endColumn\":136}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":22,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for url\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":55,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":56,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for response\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":72,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/http.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":8},\"region\":{\"startLine\":28,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1206,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":29,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for http [Attribute get_text]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":29,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":552,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":555,\"startColumn\":16,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":17,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for json_decode()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1209,\"startColumn\":13,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for arr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1234,\"startColumn\":24,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":33,\"endColumn\":103}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":223,\"startColumn\":29,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for res\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":227,\"startColumn\":27,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for res\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/kcweb.py\n行号: 227\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 216 到 216 ）：\n                            res=server.uploadplug(cmd_par[\'plug\'],cmd_par[\'username\'],cmd_par[\'password\'],cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 997 到 997 ）：\n    def uploadplug(self,plug,username=\'\',password=\'\',cli=False):\n\n\n代码 kcweb/common/autoload.py 片段（行 1010 到 1010 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/userinfo/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign)\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/utill/http.py 片段（行 55 到 55 ）：\n        response=self.req.request(method, url,data=data,params=params,json=jsonparams,files=files,proxies=self.set_proxies,cookies=self.set_cookies,headers=self.set_header,timeout=self.set_timeout,verify=self.set_verify,allow_redirects=allow_redirects)\n\n\n代码 kcweb/utill/http.py 片段（行 56 到 56 ）：\n        response.encoding=self.set_encoding\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 72 到 72 ）：\n        self.get_text=response.text\n\n\n代码 kcweb/utill/http.py 片段（行 28 到 28 ）：\n    def openurl(self,url,method=\"GET\",data=None,params=None,jsonparams=None,files=None,allow_redirects=True):\n\n\n代码 kcweb/common/autoload.py 片段（行 1010 到 1010 ）：\n            http.openurl(config.domain[\'kcwebapi\']+\"/user/userinfo/?username=\"+username+\"&timestamp=\"+str(timestamp)+\"&sign=\"+sign)\n\n\n代码 kcweb/common/autoload.py 片段（行 1011 到 1011 ）：\n            arr=json_decode(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1011 到 1011 ）：\n            arr=json_decode(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 552 到 552 ）：\ndef json_decode(strs):\n\n\n代码 kcweb/common/autoload.py 片段（行 555 到 555 ）：\n        return json.loads(strs)\n\n\n代码 kcweb/common/autoload.py 片段（行 1011 到 1011 ）：\n            arr=json_decode(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1011 到 1011 ）：\n            arr=json_decode(http.get_text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1033 到 1033 ）：\n                return False,arr[\'msg\']\n\n\n代码 kcweb/kcweb.py 片段（行 216 到 216 ）：\n                            res=server.uploadplug(cmd_par[\'plug\'],cmd_par[\'username\'],cmd_par[\'password\'],cli=True)\n\n\n代码 kcweb/kcweb.py 片段（行 216 到 216 ）：\n                            res=server.uploadplug(cmd_par[\'plug\'],cmd_par[\'username\'],cmd_par[\'password\'],cli=True)\n\n\n代码 kcweb/kcweb.py 片段（行 227 到 227 ）：\n                    print(res)\n\n\n\n-------------------------------', '根据提供的审计提示，您在 `kcweb.py` 文件中发现了两个潜在的安全漏洞。这些漏洞类型为 `py/clear-text-logging-sensitive-data`，涉及清晰文本形式的敏感数据（密码）泄露。以下是具体的问题：\n\n1. 在 `kcweb.py` 的第 28 行和第 96 行，有两个变量 `password=\'\'`，这表明密码可能没有安全处理就被直接设置为空字符串。这可能导致在后续代码中直接暴露密码。\n\n2. 在第 216 行，`server.uploadplug()` 函数调用中，`cmd_par[\'password\']` 直接被用于请求中，如果这个参数没有经过加密或安全处理，它会被明文发送到服务器。\n\n3. 在 `common/autoload.py` 的 `uploadplug()` 方法中，有对用户信息的请求，`http.openurl()` 函数会将 `password` 参数包含在 URL 中，这种做法同样不安全，因为HTTP请求通常是明文传输的。\n\n4. 在 `http.py` 中，`openurl()` 和 `json_decode()` 方法的使用可能会导致响应内容中的敏感数据被明文解析，如在 `arr=json_decode(http.get_text)` 这样的代码行中。\n\n修复这些问题需要确保密码和其他敏感信息在存储和传输过程中进行加密或适当的混淆处理。通常的做法是使用哈希函数（如bcrypt或SHA-256）对密码进行存储，并且在需要时使用安全的API调用来执行操作，避免直接暴露明文密码。同时，确保HTTP请求使用HTTPS以加密通信。', '2024-06-16 14:37:26');
INSERT INTO `codeql` VALUES (32, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":72}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":40,\"endColumn\":65}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":39,\"endColumn\":66}},\"message\":{\"text\":\"ControlFlowNode for List\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":13,\"endColumn\":26}},\"message\":{\"text\":\"[post] ControlFlowNode for Attribute [Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":72,\"startColumn\":22,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":326,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":328,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":329,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":330,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":106,\"startColumn\":20,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":129}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":138}},\"message\":{\"text\":\"ControlFlowNode for Attribute [Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":45,\"endColumn\":176}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":40,\"endColumn\":65}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":39,\"endColumn\":66}},\"message\":{\"text\":\"ControlFlowNode for List [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":13,\"endColumn\":26}},\"message\":{\"text\":\"[post] ControlFlowNode for Attribute [Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":72,\"startColumn\":22,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":326,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":328,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":329,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":330,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":106,\"startColumn\":20,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":129}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":138}},\"message\":{\"text\":\"ControlFlowNode for Attribute [Dictionary element at key password, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for Subscript [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":153}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":45,\"endColumn\":176}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":40,\"endColumn\":65}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":39,\"endColumn\":66}},\"message\":{\"text\":\"ControlFlowNode for List\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":13,\"endColumn\":26}},\"message\":{\"text\":\"[post] ControlFlowNode for Attribute [Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":81,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":72,\"startColumn\":22,\"endColumn\":26}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":402,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":404,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":405,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":406,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":106,\"startColumn\":20,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":129}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __config, Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":138}},\"message\":{\"text\":\"ControlFlowNode for Attribute [Dictionary element at key password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":45,\"endColumn\":176}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":125,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":45,\"endColumn\":176}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":127,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __masteridentifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/mysql.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":9},\"region\":{\"startLine\":134,\"startColumn\":49,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/utill/db/mysql.py\n行号: 134\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\nThis expression logs [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/utill/db/mysql.py 片段（行 81 到 81 ）：\n            self.__config[\'password\']=[self.__config[\'password\']]\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 81 到 81 ）：\n            self.__config[\'password\']=[self.__config[\'password\']]\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 81 到 81 ）：\n            self.__config[\'password\']=[self.__config[\'password\']]\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 81 到 81 ）：\n            self.__config[\'password\']=[self.__config[\'password\']]\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 72 到 72 ）：\n    def __setdbcount(self):\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 326 到 326 ）：\n        self.__setdbcount()\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 328 到 328 ）：\n        self.__dbObjcount=self.__config[\'dbObjcount\']\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 329 到 329 ）：\n        self.__errorcount=self.__config[\'break\']\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 330 到 330 ）：\n        self.__connects()\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 106 到 106 ）：\n    def __connects(self,typess=\"DQL\"):\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 127 到 127 ）：\n                    self.__masteridentifier=self.__config[\'host\'][0]+str(self.__config[\'port\'][0])+self.__config[\'user\'][0]+self.__config[\'password\'][0]+self.__config[\'db\'][0] # 服务器标识\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 127 到 127 ）：\n                    self.__masteridentifier=self.__config[\'host\'][0]+str(self.__config[\'port\'][0])+self.__config[\'user\'][0]+self.__config[\'password\'][0]+self.__config[\'db\'][0] # 服务器标识\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 127 到 127 ）：\n                    self.__masteridentifier=self.__config[\'host\'][0]+str(self.__config[\'port\'][0])+self.__config[\'user\'][0]+self.__config[\'password\'][0]+self.__config[\'db\'][0] # 服务器标识\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 127 到 127 ）：\n                    self.__masteridentifier=self.__config[\'host\'][0]+str(self.__config[\'port\'][0])+self.__config[\'user\'][0]+self.__config[\'password\'][0]+self.__config[\'db\'][0] # 服务器标识\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 127 到 127 ）：\n                    self.__masteridentifier=self.__config[\'host\'][0]+str(self.__config[\'port\'][0])+self.__config[\'user\'][0]+self.__config[\'password\'][0]+self.__config[\'db\'][0] # 服务器标识\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 134 到 134 ）：\n                            print(\"mysql短连接已创建\",self.__masteridentifier,mysql.__conn[self.__masteridentifier])\n\n\n代码 kcweb/utill/db/mysql.py 片段（行 134 到 134 ）：\n                            print(\"mysql短连接已创建\",self.__masteridentifier,mysql.__conn[self.__masteridentifier])\n\n\n\n-------------------------------', '这段代码中存在一个清晰文本日志泄露敏感数据的漏洞。在`__masteridentifier`变量的设置和打印语句中，密码字段被直接拼接到字符串中并输出到控制台，这可能会导致密码等敏感信息被不当地记录或显示。为修复这个漏洞，你应该确保密码在日志输出时进行适当的加密或者使用安全的方式传递，比如使用占位符、环境变量或配置文件，只在必要时解密。\n\n以下是一些建议的修复措施：\n\n1. **密码加密**：在存储或传递密码时，使用哈希函数（如bcrypt或Argon2）对其进行加密。这样即使日志被泄露，密码也无法直接还原。\n\n2. **环境变量或配置文件**：将敏感配置如密码存储在环境变量或配置文件中，而不是硬编码在代码中。在需要使用时再读取这些值。\n\n3. **日志输出**：对密码部分使用`*`或其他符号进行替换，以隐藏其实际内容。例如，可以使用`print(\"mysql短连接已创建\", self.__masteridentifier, \"****\")`。\n\n4. **代码重构**：将密码处理逻辑移到一个单独的方法中，并确保该方法只在安全的情况下执行，如连接数据库时。\n\n5. **日志级别**：如果确实需要记录密码用于调试，确保它们仅在日志级别设置为`DEBUG`或更低的情况下记录，而在生产环境中设置为`INFO`或更高级别。\n\n请根据实际情况选择合适的修复策略，并确保在整个代码库中执行一致性，防止类似问题在其他地方重现。', '2024-06-16 14:37:32');
INSERT INTO `codeql` VALUES (33, 'py/clear-text-logging-sensitive-data', 'This expression logs [sensitive data (password)](1) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/redis.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":10},\"region\":{\"startLine\":23,\"startColumn\":40,\"endColumn\":57}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/redis.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":10},\"region\":{\"startLine\":15,\"startColumn\":53,\"endColumn\":78}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/redis.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":10},\"region\":{\"startLine\":15,\"startColumn\":31,\"endColumn\":130}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/redis.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":10},\"region\":{\"startLine\":15,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute __identifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/redis.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":10},\"region\":{\"startLine\":23,\"startColumn\":40,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute __identifier]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/redis.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":10},\"region\":{\"startLine\":23,\"startColumn\":40,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-logging-sensitive-data\n文件路径: kcweb/utill/redis.py\n行号: 23\n\n漏洞描述:\nThis expression logs [sensitive data (password)](1) as clear text.\n\n漏洞代码片段:\n代码 kcweb/utill/redis.py 片段（行 15 到 15 ）：\n            self.__identifier=self.__config[\'host\']+self.__config[\'password\']+str(self.__config[\'port\'])+str(self.__config[\'db\'])\n\n\n代码 kcweb/utill/redis.py 片段（行 15 到 15 ）：\n            self.__identifier=self.__config[\'host\']+self.__config[\'password\']+str(self.__config[\'port\'])+str(self.__config[\'db\'])\n\n\n代码 kcweb/utill/redis.py 片段（行 15 到 15 ）：\n            self.__identifier=self.__config[\'host\']+self.__config[\'password\']+str(self.__config[\'port\'])+str(self.__config[\'db\'])\n\n\n代码 kcweb/utill/redis.py 片段（行 23 到 23 ）：\n                    print(\"建立redis连接池\",self.__identifier)\n\n\n代码 kcweb/utill/redis.py 片段（行 23 到 23 ）：\n                    print(\"建立redis连接池\",self.__identifier)\n\n\n\n-------------------------------', '你好，根据提供的审计提示，存在一个`py/clear-text-logging-sensitive-data`类型的漏洞。在`kcweb/utill/redis.py`文件中，第23行的代码有敏感数据（这里看起来像是数据库密码）被明文打印出来。这可能会导致安全风险，因为密码作为清晰文本存储或输出时，一旦被中间人截获，就容易被破解。\n\n修复这个漏洞的建议是：\n\n1. 不要在日志或打印语句中直接包含密码或敏感信息。可以考虑使用以下方式来保护密码：\n   - 使用一个安全的函数或方法来生成或处理密码，该函数只在需要时提供给实际使用的代码。\n   - 将密码转换为哈希值或者使用密钥管理服务来存储和检索密码，而不是硬编码在代码中。\n\n2. 如果必须在日志中记录密码相关的信息，确保它们被脱敏或者加密后再进行记录。\n\n3. 如果密码是在构造字符串时与其他参数组合的，可以考虑使用参数化查询或类似的方法来避免直接拼接。\n\n请检查并修改这些代码片段，确保敏感数据的安全性。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (34, 'py/clear-text-storage-sensitive-data', 'This expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1159,\"startColumn\":25,\"endColumn\":29}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":48,\"endColumn\":63}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1060,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1158,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for text\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1159,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for text\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":48,\"endColumn\":63}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":26,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1060,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1158,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for text\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1159,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for text\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-storage-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1159\n\n漏洞描述:\nThis expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 185 到 185 ）：\n                        res=server.installplug(cmd_par[\'plug\'],cli=True,username=cmd_par[\'username\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 1055 到 1055 ）：\n    def installplug(self,plug,edition=\'\',token=\'\',cli=False,mandatory=False,username=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1060 到 1060 ）：\n        plug=str(plug)\n\n\n代码 kcweb/common/autoload.py 片段（行 1158 到 1158 ）：\n                text+=\"\\nfrom . import \"+plug\n\n\n代码 kcweb/common/autoload.py 片段（行 1159 到 1159 ）：\n                f.write(text)\n\n\n\n-------------------------------', '根据提供的审计提示，存在一个`py/clear-text-storage-sensitive-data`类型的漏洞。在这个Python代码中，敏感数据（密码）以明文形式存储在以下几个位置：\n\n1. 在`kcweb/kcweb.py`的第28行和第28行，有两个变量`password=\'\'`，没有加密直接使用。\n2. 在`kcweb/kcweb.py`的第89到94行的字典返回值中，将`password`作为明文传递。\n3. 在`kcweb/kcweb.py`的第96和96行，通过`__get_cmd_par()`获取的参数中可能包含密码，也未加密。\n4. `kcweb/common/autoload.py`中的`installplug`方法接收`username`参数，这个参数在某些场景下可能是密码。\n5. 在`kcweb/common/autoload.py`的第1158到1159行，似乎是在动态创建代码字符串，其中包含`username`，可能被写入文件，这同样可能导致明文密码暴露。\n\n为了修复这个问题，你应该确保密码在存储或传输过程中进行加密，比如使用哈希函数（如bcrypt）和安全的盐值。不要直接在代码中硬编码明文密码，而是应该使用安全的存储方式，如环境变量、配置文件或安全的数据库存储。在需要提供给用户时，也应该通过安全的方式进行交互，例如使用HTTPS进行通信。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (35, 'py/clear-text-storage-sensitive-data', 'This expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1167,\"startColumn\":25,\"endColumn\":29}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":51}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":22,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for text\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1167,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for text\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":56,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":22,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for text\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1167,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for text\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":43}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":51}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":22,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for text\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1167,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for text\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":29,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1055,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":56,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":39,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":22,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1165,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for text\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1167,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for text\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-storage-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1167\n\n漏洞描述:\nThis expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 185 到 185 ）：\n                        res=server.installplug(cmd_par[\'plug\'],cli=True,username=cmd_par[\'username\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 1055 到 1055 ）：\n    def installplug(self,plug,edition=\'\',token=\'\',cli=False,mandatory=False,username=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1165 到 1165 ）：\n                text=re.sub(\"app.api\",self.appname+\".\"+self.modular,text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1165 到 1165 ）：\n                text=re.sub(\"app.api\",self.appname+\".\"+self.modular,text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1165 到 1165 ）：\n                text=re.sub(\"app.api\",self.appname+\".\"+self.modular,text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1165 到 1165 ）：\n                text=re.sub(\"app.api\",self.appname+\".\"+self.modular,text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1165 到 1165 ）：\n                text=re.sub(\"app.api\",self.appname+\".\"+self.modular,text)\n\n\n代码 kcweb/common/autoload.py 片段（行 1167 到 1167 ）：\n                f.write(text)\n\n\n\n-------------------------------', '这个审计提示指出在kcweb项目的`kcweb/common/autoload.py`文件的第1167行存在一个清晰文本存储敏感数据（密码）的漏洞。在代码片段中，可以看到在多个地方直接使用了`password`变量，没有对密码进行加密或安全处理，就将其写入到了文件（f.write(text)）中。这可能导致密码在传输或存储过程中被未经授权的第三方获取。\n\n修复这个漏洞的建议是：\n\n1. 不要在代码中明文存储密码，尤其是写入到文件或者作为API返回值。密码应该通过安全的方式（如哈希和盐值）存储，并且仅在验证用户身份时临时解密。\n\n2. 对敏感信息进行加密，例如使用安全的加密算法（如bcrypt、argon2等）对密码进行加密后再存储或传输。\n\n3. 如果密码需要传递给其他函数或组件，确保传递的是加密后的版本，接收端再解密处理。\n\n4. 使用环境变量或配置文件来存储敏感信息，而不是硬编码在代码中。\n\n5. 定期检查和更新代码，确保所有敏感数据处理逻辑符合安全最佳实践。\n\n请根据上述建议修改相关代码以保护用户密码的安全。', '2024-06-16 14:37:38');
INSERT INTO `codeql` VALUES (36, 'py/clear-text-storage-sensitive-data', 'This expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1290,\"startColumn\":25,\"endColumn\":35}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1282,\"startColumn\":35,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1282,\"startColumn\":35,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1280,\"startColumn\":17,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1290,\"startColumn\":25,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1282,\"startColumn\":35,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1282,\"startColumn\":35,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1280,\"startColumn\":17,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1290,\"startColumn\":25,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-storage-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1290\n\n漏洞描述:\nThis expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1254 到 1254 ）：\n    def installmodular(self,token=\'\',cli=False,package=\'kcweb\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1282 到 1282 ）：\n                        \'import \'+self.appname+\' as application\\n\'+\n\n\n代码 kcweb/common/autoload.py 片段（行 1282 到 1282 ）：\n                        \'import \'+self.appname+\' as application\\n\'+\n\n\n代码 kcweb/common/autoload.py 片段（行 1280 到 1280 ）：\n                servertext=(\'#生产环境运行文件，请务修改\\n\'+\n\n\n代码 kcweb/common/autoload.py 片段（行 1290 到 1290 ）：\n                f.write(servertext)\n\n\n\n-------------------------------', '您好，看起来您提供的是一个关于Python Web应用程序中可能存在的安全漏洞信息。在这个案例中，`clear-text-storage-sensitive-data`类型的漏洞意味着在代码中存储了敏感数据（如密码），而这些数据是以明文形式出现的，这可能会增加数据泄露的风险。\n\n具体到给出的代码片段：\n\n1. 几个地方出现了 `password=\'\'` 或空字符串，这表明密码变量没有初始化或赋值，如果后续代码中直接使用了这个变量，那就是明文存储密码。\n\n2. 在`create()`函数和`__init__()`方法中，`cmd_par[\'password\']`或`self.appname`可能包含了用户输入的密码，需要确保这些值在使用前已经进行了加密或者安全处理。\n\n3. `installmodular()`和`autoload.py`中的代码片段显示有导入模块并使用`application`变量，这可能涉及到应用的配置，确保这部分代码不会暴露密码。\n\n为了修复这个漏洞，建议进行以下操作：\n\n- 对密码进行加密后再存储或传递。\n- 使用环境变量、加密后的密钥或者其他安全的方式来存储敏感信息，而不是直接在代码中明文显示。\n- 检查所有可能使用密码的地方，确保它们在使用前已安全处理。\n- 更新代码以遵循安全最佳实践，例如使用`getpass`模块来获取用户输入的密码，而不是直接显示在控制台上。\n\n请务必审查并更新您的代码库，确保敏感数据的安全性。', '2024-06-16 14:10:41');
INSERT INTO `codeql` VALUES (37, 'py/clear-text-storage-sensitive-data', 'This expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1411,\"startColumn\":37,\"endColumn\":44}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1409,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1409,\"startColumn\":56,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1409,\"startColumn\":29,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for content\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1411,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for content\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1409,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1409,\"startColumn\":56,\"endColumn\":68}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1409,\"startColumn\":29,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for content\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1411,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for content\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-storage-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1411\n\n漏洞描述:\nThis expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 963 到 963 ）：\n        self.modular=str(modular)\n\n\n代码 kcweb/common/autoload.py 片段（行 963 到 963 ）：\n        self.modular=str(modular)\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1254 到 1254 ）：\n    def installmodular(self,token=\'\',cli=False,package=\'kcweb\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1409 到 1409 ）：\n                            content=\"\\nfrom . import \"+self.modular\n\n\n代码 kcweb/common/autoload.py 片段（行 1409 到 1409 ）：\n                            content=\"\\nfrom . import \"+self.modular\n\n\n代码 kcweb/common/autoload.py 片段（行 1409 到 1409 ）：\n                            content=\"\\nfrom . import \"+self.modular\n\n\n代码 kcweb/common/autoload.py 片段（行 1411 到 1411 ）：\n                            f.write(content)\n\n\n\n-------------------------------', '这个审计提示指出在 `kcweb` 项目中的 `kcweb/kcweb.py` 和 `kcweb/common/autoload.py` 文件中存在清晰文本存储敏感数据（密码）的漏洞。具体来说，以下几个部分涉及了明文存储或处理密码：\n\n1. 在 `kcweb/kcweb.py` 的第 28 行和第 89-94 行，`password` 变量直接被赋值，没有进行加密。\n2. 在 `kcweb/kcweb.py` 的第 96 和 182 行，`__get_cmd_par()` 函数可能返回包含密码的字典，如果这些密码未经过安全处理，也会暴露在明文中。\n3. 在 `kcweb/common/autoload.py` 中：\n   - 第 961 行的 `__init__` 方法接受 `project` 参数，这可能导致在某些情况下存储明文密码。\n   - 第 963 行将 `modular` 转换为字符串，但在这个上下文中，它似乎与密码无关。\n   - 第 1254 行的 `installmodular` 方法接受 `cli` 参数，但没有提及密码如何处理，如果涉及密码，需要确保正确加密。\n   - 第 1409-1411 行，`f.write(content)` 用于写入内容到文件，如果 `content` 包含从数据库或其他地方获取的密码，这里也可能存在泄露风险。\n\n为了修复这个漏洞，你需要对涉及密码的部分进行加密，比如使用哈希和盐值来存储密码，或者在传递给其他函数或持久化存储时对其进行适当的处理。同时，确保在整个应用中遵循安全最佳实践，例如使用安全的密码管理库、避免明文存储敏感信息，并确保数据传输过程中使用加密。', '2024-06-16 14:37:47');
INSERT INTO `codeql` VALUES (38, 'py/clear-text-storage-sensitive-data', 'This expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1424,\"startColumn\":37,\"endColumn\":86}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1424,\"startColumn\":45,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1424,\"startColumn\":45,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1424,\"startColumn\":37,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1424,\"startColumn\":45,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1424,\"startColumn\":45,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1424,\"startColumn\":37,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-storage-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1424\n\n漏洞描述:\nThis expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1254 到 1254 ）：\n    def installmodular(self,token=\'\',cli=False,package=\'kcweb\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1424 到 1424 ）：\n                            f.write(\"from \"+self.appname+\".common import *\\n\"+content)\n\n\n代码 kcweb/common/autoload.py 片段（行 1424 到 1424 ）：\n                            f.write(\"from \"+self.appname+\".common import *\\n\"+content)\n\n\n代码 kcweb/common/autoload.py 片段（行 1424 到 1424 ）：\n                            f.write(\"from \"+self.appname+\".common import *\\n\"+content)\n\n\n\n-------------------------------', '这个审计提示指出在 `kcweb` 项目的不同部分，存在 `clear-text-storage-sensitive-data` 类型的漏洞。具体来说，密码数据（`password`）以明文形式存储或传递。以下是涉及的代码片段：\n\n1. 在 `kcweb/kcweb.py` 文件中，有两处可能泄露密码的地方：\n   - 行 28 和 28：直接赋值给 `password` 变量，没有加密。\n   - 行 89 到 94 的字典返回中包含了 `password`。\n\n2. 函数 `__get_cmd_par()` 可能从用户输入或其他来源获取敏感数据。\n\n3. `kcweb/kcweb.py` 的 `create()` 调用和 `autoload.py` 的 `__init__()` 方法中，`appname` 和 `modular` 可能包含了敏感信息。\n\n4. `autoload.py` 的 `installmodular()` 函数接受 `cli` 参数，可能影响到密码处理方式。\n\n5. 在 `autoload.py` 的 `__init__()` 方法和 `f.write()` 语句（行 1424）中，`self.appname` 可能用于构建导入路径，这可能导致敏感信息暴露在源码中。\n\n为了修复这些漏洞，你应该：\n\n- 对密码进行加密，确保在存储和传输过程中不以明文形式出现。\n- 使用安全的方式处理命令行参数，避免直接暴露敏感信息。\n- 尽可能避免在源代码中直接包含敏感应用名称（如 `appname`），尤其是当它们用于构建动态导入路径时。\n- 如果 `f.write()` 是用于动态生成代码，确保字符串替换或模板化处理敏感数据。\n\n请根据上述建议检查并更新你的代码，以保护敏感信息的安全。', '2024-06-16 14:37:55');
INSERT INTO `codeql` VALUES (39, 'py/clear-text-storage-sensitive-data', 'This expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":37,\"endColumn\":103}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":45,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":45,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":37,\"endColumn\":103}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":62,\"endColumn\":66}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":62,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":37,\"endColumn\":103}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":45,\"endColumn\":49}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":45,\"endColumn\":57}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":37,\"endColumn\":103}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":54,\"endColumn\":72}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":37,\"endColumn\":44}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":963,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":62,\"endColumn\":66}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute modular]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":62,\"endColumn\":74}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1437,\"startColumn\":37,\"endColumn\":103}},\"message\":{\"text\":\"ControlFlowNode for BinaryExpr\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-storage-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1437\n\n漏洞描述:\nThis expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1254 到 1254 ）：\n    def installmodular(self,token=\'\',cli=False,package=\'kcweb\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1437 到 1437 ）：\n                            f.write(\"from \"+self.appname+\".\"+self.modular+\".common import *\\n\"+content)\n\n\n代码 kcweb/common/autoload.py 片段（行 1437 到 1437 ）：\n                            f.write(\"from \"+self.appname+\".\"+self.modular+\".common import *\\n\"+content)\n\n\n代码 kcweb/common/autoload.py 片段（行 1437 到 1437 ）：\n                            f.write(\"from \"+self.appname+\".\"+self.modular+\".common import *\\n\"+content)\n\n\n\n-------------------------------', '这个审计提示指出在 `kcweb/common/autoload.py` 文件的第1437行存在一个潜在的安全问题。具体来说，它发现存储敏感数据（密码）的方式没有进行加密或安全处理，而是以明文形式存在。这可能导致密码泄露，增加系统被攻击的风险。\n\n在提供的代码片段中，可以看到以下部分：\n\n1. 几处 `password=\'\'` 的定义，这可能表示空密码，但如果在实际应用中使用了这个变量，且没有后续加密，就是安全隐患。\n2. 在 `kcweb/kcweb.py` 的第96和96行以及第182行，`__get_cmd_par()` 函数返回的 `password` 可能包含明文密码。\n3. `autoload.py` 的 `__init__` 方法和 `installmodular` 方法中，`appname` 和 `modular` 变量用于构建字符串，如果这些变量也包含了敏感信息，同样需要处理。\n4. `autoload.py` 的第1437行，将包含 `appname` 和 `modular` 的字符串拼接到代码中，这种动态生成的代码可能导致敏感数据暴露。\n\n为了修复这个问题，你应该确保密码在存储、传输和处理过程中始终加密，并遵循安全最佳实践，比如使用哈希函数（如bcrypt）对密码进行散列，然后只存储散列值。同时，避免在代码中直接显示敏感数据，尤其是在动态生成的代码中。', '2024-06-16 14:38:01');
INSERT INTO `codeql` VALUES (40, 'py/clear-text-storage-sensitive-data', 'This expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1455,\"startColumn\":37,\"endColumn\":47}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":96,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":96,\"endColumn\":108}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":29,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1455,\"startColumn\":37,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":18,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":28,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1449,\"startColumn\":47,\"endColumn\":51}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1449,\"startColumn\":47,\"endColumn\":59}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":29,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1455,\"startColumn\":37,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":96,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":96,\"endColumn\":108}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":29,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1455,\"startColumn\":37,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":26,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":55,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":35,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":23,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for appname\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":22,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for str()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":962,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":961,\"startColumn\":18,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for self [Return] [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":28,\"endColumn\":100}},\"message\":{\"text\":\"ControlFlowNode for create() [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":182,\"startColumn\":21,\"endColumn\":27}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":183,\"startColumn\":23,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for server [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1254,\"startColumn\":24,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1449,\"startColumn\":47,\"endColumn\":51}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute appname]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1449,\"startColumn\":47,\"endColumn\":59}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1447,\"startColumn\":29,\"endColumn\":39}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1455,\"startColumn\":37,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for servertext\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/clear-text-storage-sensitive-data\n文件路径: kcweb/common/autoload.py\n行号: 1455\n\n漏洞描述:\nThis expression stores [sensitive data (password)](1) as clear text.\nThis expression stores [sensitive data (password)](2) as clear text.\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 28 到 28 ）：\n        password=\'\'\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 962 到 962 ）：\n        self.appname=str(appname)\n\n\n代码 kcweb/common/autoload.py 片段（行 961 到 961 ）：\n    def __init__(self,appname=\"app\",modular=\"api\",project=\'\'):\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 182 到 182 ）：\n                    server=create(cmd_par[\'appname\'],cmd_par[\'modular\'],project=cmd_par[\'project\'])\n\n\n代码 kcweb/kcweb.py 片段（行 183 到 183 ）：\n                    t=server.installmodular(cli=True)\n\n\n代码 kcweb/common/autoload.py 片段（行 1254 到 1254 ）：\n    def installmodular(self,token=\'\',cli=False,package=\'kcweb\'):\n\n\n代码 kcweb/common/autoload.py 片段（行 1447 到 1447 ）：\n                            servertext=(\'# -*- coding: utf-8 -*-\\n#gunicorn -b 0.0.0.0:39010 \'+self.appname+\':app\\n\'+\n\n\n代码 kcweb/common/autoload.py 片段（行 1447 到 1447 ）：\n                            servertext=(\'# -*- coding: utf-8 -*-\\n#gunicorn -b 0.0.0.0:39010 \'+self.appname+\':app\\n\'+\n\n\n代码 kcweb/common/autoload.py 片段（行 1447 到 1447 ）：\n                            servertext=(\'# -*- coding: utf-8 -*-\\n#gunicorn -b 0.0.0.0:39010 \'+self.appname+\':app\\n\'+\n\n\n代码 kcweb/common/autoload.py 片段（行 1455 到 1455 ）：\n                            f.write(servertext)\n\n\n\n-------------------------------', '这段审计提示指出存在一个 `py/clear-text-storage-sensitive-data` 类型的漏洞，涉及存储敏感数据（密码）以明文形式。以下是相关代码片段：\n\n1. 在 `kcweb/kcweb.py` 的不同位置，`password` 变量被直接用于构建返回的对象，如：\n   ```python\n   \'password\':password\n   ```\n   这意味着密码在传输或存储过程中没有加密。\n\n2. 在 `kcweb/common/autoload.py` 中，`__init__` 方法中，`appname` 和可能包含密码的参数（例如在`create` 函数调用中）也作为字符串存储，没有加密处理。\n\n3. 在 `installmodular` 和 `servertext` 构造中，密码可能出现在服务器配置字符串中，这同样可能导致明文存储或传输。\n\n这些代码片段显示了密码以清晰文本的形式存储或使用，这不符合安全最佳实践，因为这样做容易导致数据泄露。为了修复这个漏洞，应该使用安全的方式处理密码，例如哈希和盐值加密，并且在存储和传输时始终确保加密。同时，避免在输出和配置文件中直接写入明文密码。', '2024-06-16 14:38:06');
INSERT INTO `codeql` VALUES (41, 'py/insecure-default-protocol', 'Call to deprecated method ssl.wrap_socket does not specify a protocol, which may result in an insecure default being used.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/rediss\\/connection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":11},\"region\":{\"startLine\":822,\"startColumn\":20,\"endLine\":826,\"endColumn\":59}}}]', '[]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/insecure-default-protocol\n文件路径: kcweb/utill/rediss/connection.py\n行号: 822\n\n漏洞描述:\nCall to deprecated method ssl.wrap_socket does not specify a protocol, which may result in an insecure default being used.\n\n漏洞代码片段:\n            sock = ssl.wrap_socket(sock,\n\n-------------------------------', '这段审计提示指出了一个Python代码中的安全问题，涉及`ssl.wrap_socket`方法的使用。`ssl.wrap_socket`在Python中用于包装套接字以启用SSL/TLS加密，但如果没有指定具体的协议（如`ssl.PROTOCOL_TLSv1_2`或更高版本），它可能会默认使用较旧或不安全的协议，如`PROTOCOL_SSLv23`，这可能导致潜在的安全风险。\n\n修复这个漏洞的建议是：\n\n1. 确保在调用`wrap_socket`时指定了一个推荐的、安全性较高的SSL/TLS协议版本，例如：\n```python\nimport ssl\nsock = ssl.wrap_socket(sock, ssl_version=ssl.PROTOCOL_TLSv1_2)\n```\n或者，如果你需要兼容性，可以使用`ssl.PROTOCOL_SSLv23`，但同时也要注意这可能引入的风险，并确保你的目标环境支持的最高安全级别。\n\n2. 如果可能，更新你的库和依赖，因为许多现代库已经移除了对不安全协议的支持。\n\n3. 在代码审查和维护过程中，定期检查并更新这种潜在过时的方法，以保持最佳安全实践。\n\n请根据你的具体环境和需求来实施相应的修复措施。', '2024-06-16 14:38:12');
INSERT INTO `codeql` VALUES (42, 'py/insecure-protocol', 'Insecure SSL/TLS protocol version TLSv1 allowed by [call to ssl.create_default_context](1).\nInsecure SSL/TLS protocol version TLSv1_1 allowed by [call to ssl.create_default_context](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/rediss\\/connection.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":11},\"region\":{\"startLine\":818,\"startColumn\":20,\"endColumn\":27}}}]', '[]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/insecure-protocol\n文件路径: kcweb/utill/rediss/connection.py\n行号: 818\n\n漏洞描述:\nInsecure SSL/TLS protocol version TLSv1 allowed by [call to ssl.create_default_context](1).\nInsecure SSL/TLS protocol version TLSv1_1 allowed by [call to ssl.create_default_context](1).\n\n漏洞代码片段:\n            sock = context.wrap_socket(sock, server_hostname=self.host)\n\n-------------------------------', '您提供的审计提示指出存在一个安全漏洞，涉及使用不安全的SSL/TLS协议版本。在`kcweb/utill/rediss/connection.py`文件的第818行，`ssl.create_default_context`函数允许TLSv1和TLSv1_1这样的较旧版本的协议，这些版本可能不再被认为是安全的，特别是对于现代应用而言，因为它们可能存在已知的安全问题。\n\n为了解决这个问题，建议更新代码以使用更安全的SSL/TLS版本，如TLSv1.2或更高。这通常可以通过传递一个`context`参数给`wrap_socket`，并指定`ssl.PROTOCOL_TLSv1_2`或其他安全的协议选项来实现。示例代码如下：\n\n```python\nimport ssl\n\n# 创建一个只允许特定安全协议的上下文\nsecure_protocol = ssl.PROTOCOL_TLSv1_2\n\n# ...\nsock = context.wrap_socket(sock, server_hostname=self.host, proto=secure_protocol)\n```\n\n确保您的系统库支持所选择的协议，并且服务器也支持与之兼容的协议。同时，定期检查并更新依赖库以获取最新的安全更新也是必要的。', '2024-06-16 14:38:17');
INSERT INTO `codeql` VALUES (43, 'py/insecure-protocol', 'Insecure SSL/TLS protocol version TLSv1 allowed by [call to ssl.create_default_context](1).\nInsecure SSL/TLS protocol version TLSv1_1 allowed by [call to ssl.create_default_context](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":803,\"startColumn\":26,\"endColumn\":34}}}]', '[]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/insecure-protocol\n文件路径: kcweb/utill/db/pymysql/connections.py\n行号: 803\n\n漏洞描述:\nInsecure SSL/TLS protocol version TLSv1 allowed by [call to ssl.create_default_context](1).\nInsecure SSL/TLS protocol version TLSv1_1 allowed by [call to ssl.create_default_context](1).\n\n漏洞代码片段:\n            self._sock = self.ctx.wrap_socket(self._sock, server_hostname=self.host)\n\n-------------------------------', '您提供的审计提示指出存在一个安全漏洞，涉及到使用不安全的SSL/TLS协议版本（TLSv1和TLSv1_1）。在`kcweb/utill/db/pymysql/connections.py`文件的第803行，有一个代码片段可能允许创建默认的SSL上下文，这个上下文可能允许这些较低的安全版本。\n\n`ssl.create_default_context`方法默认创建的是兼容旧版本协议的上下文，这在某些情况下可能会被利用来进行中间人攻击，因为这些较早的协议版本可能存在已知的安全漏洞。为了修复这个问题，应该使用`create_default_context()`时指定更安全的参数，例如：\n\n```python\nfrom ssl import PROTOCOL_TLS, PROTOCOL_TLS_SERVER\n\n# 更安全的选择，限制到至少TLSv1.2\nself.ctx = ssl.create_default_context(\n    purpose=ssl.Purpose.SERVER_AUTH,\n    proto=ssl.PROTOCOL_TLS or ssl.PROTOCOL_TLS_SERVER,\n    ciphers=\'TLSv1.2\'  # 或者根据需要选择其他安全级别\n)\n```\n\n确保只支持那些已经不再受攻击的协议版本，并且定期更新以保持最新的安全标准。同时，如果可能的话，建议与应用的配置管理或安全团队合作，进行全面的评估和升级。', '2024-06-16 14:38:22');
INSERT INTO `codeql` VALUES (44, 'py/weak-sensitive-data-hashing', '[Sensitive data (password)](1) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](2) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](3) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](4) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](5) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](6) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](7) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](8) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](9) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](10) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](11) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](12) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](13) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](14) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](15) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](16) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](17) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](18) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":195,\"startColumn\":25,\"endColumn\":33}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":186,\"startColumn\":27,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":195,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for password\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":218,\"startColumn\":43,\"endColumn\":56}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":186,\"startColumn\":27,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":195,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for password\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":183,\"startColumn\":46,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":258,\"startColumn\":25,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for BoolExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":258,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":261,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":262,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":263,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":266,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":269,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":272,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":274,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":275,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":283,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":289,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":291,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":293,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":294,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":295,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":298,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":304,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":305,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":306,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":307,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":308,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":309,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":310,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":311,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":313,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":325,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":564,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":565,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":594,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":595,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":596,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":599,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":786,\"startColumn\":33,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":823,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":823,\"startColumn\":56,\"endColumn\":69}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":186,\"startColumn\":27,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":195,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for password\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":190,\"startColumn\":45,\"endColumn\":51}},\"message\":{\"text\":\"ControlFlowNode for passwd\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":201,\"startColumn\":13,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":258,\"startColumn\":25,\"endColumn\":40}},\"message\":{\"text\":\"ControlFlowNode for BoolExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":258,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"[post] ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":261,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":262,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":263,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":266,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":269,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":272,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":274,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":275,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":283,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":289,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":291,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":293,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":294,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":295,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":298,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":304,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":305,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":306,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":307,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":308,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":309,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":310,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":311,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":313,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":325,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":564,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":565,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":594,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":595,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":596,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":599,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":786,\"startColumn\":33,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":823,\"startColumn\":56,\"endColumn\":60}},\"message\":{\"text\":\"ControlFlowNode for self [Attribute password]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/connections.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":12},\"region\":{\"startLine\":823,\"startColumn\":56,\"endColumn\":69}},\"message\":{\"text\":\"ControlFlowNode for Attribute\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":186,\"startColumn\":27,\"endColumn\":35}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/utill\\/db\\/pymysql\\/_auth.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":13},\"region\":{\"startLine\":195,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for password\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/weak-sensitive-data-hashing\n文件路径: kcweb/utill/db/pymysql/_auth.py\n行号: 195\n\n漏洞描述:\n[Sensitive data (password)](1) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](2) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](3) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](4) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](5) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](6) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](7) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](8) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](9) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](10) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](11) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](12) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](13) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](14) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](15) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](16) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](17) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](18) is used in a hashing algorithm (SHA256) that is insecure for password hashing, since it is not a computationally expensive hash function.\n\n漏洞代码片段:\n代码 kcweb/utill/db/pymysql/_auth.py 片段（行 186 到 186 ）：\ndef scramble_caching_sha2(password, nonce):\n\n\n代码 kcweb/utill/db/pymysql/_auth.py 片段（行 195 到 195 ）：\n    p1 = hashlib.sha256(password).digest()\n\n\n\n-------------------------------', '这个审计提示指出在 `kcweb/utill/db/pymysql/_auth.py` 文件中，存在一个关于密码处理的弱点。具体来说，它提到了使用了不安全的SHA256哈希函数来存储或验证密码。SHA256虽然是一种强大的哈希算法，但并不适合直接用于密码存储，因为它不够复杂，容易被暴力破解或者彩虹表攻击。对于密码存储，通常推荐使用像bcrypt、scrypt或Argon2等设计为专门用于密码散列的慢速哈希函数。\n\n在这个代码片段中：\n\n```python\n# 这行代码可能有问题\np1 = hashlib.sha256(password).digest()\n```\n这段代码直接对密码进行SHA256哈希，如果后续没有进一步的安全增强（如添加盐值），这将使密码容易受到攻击。\n\n修复建议：\n1. 使用加盐的哈希函数，例如 `bcrypt.hashpw(password, bcrypt.gensalt())`。\n2. 或者使用Python的`argon2`库，例如 `argon2.low_level.hash_secret(secret=password, salt=None, time_cost=...)`，设置足够的工作因子（time_cost）以增加计算难度。\n\n确保在实际应用中，对密码进行适当的加密和安全处理，以保护用户数据的安全。', '2024-06-16 14:38:28');
INSERT INTO `codeql` VALUES (45, 'py/weak-sensitive-data-hashing', '[Sensitive data (password)](1) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](2) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](3) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](4) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](5) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](6) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](7) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](8) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](9) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](10) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](11) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](12) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (id)](13) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](14) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](15) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](16) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](17) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](18) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](19) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](20) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](21) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](22) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](23) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](24) is used in a hashing algorithm (MD5) that is insecure.', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":997,\"startColumn\":42,\"endColumn\":50}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1006,\"startColumn\":59,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1024,\"startColumn\":32,\"endColumn\":48}},\"message\":{\"text\":\"ControlFlowNode for input()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1024,\"startColumn\":21,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1006,\"startColumn\":59,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1027,\"startColumn\":32,\"endColumn\":48}},\"message\":{\"text\":\"ControlFlowNode for input()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1027,\"startColumn\":21,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1006,\"startColumn\":59,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1193,\"startColumn\":40,\"endColumn\":48}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":1202,\"startColumn\":59,\"endColumn\":67}},\"message\":{\"text\":\"ControlFlowNode for password\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":535,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for strs\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":543,\"startColumn\":5,\"endColumn\":6}},\"message\":{\"text\":\"ControlFlowNode for b\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/common\\/autoload.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":2},\"region\":{\"startLine\":544,\"startColumn\":14,\"endColumn\":15}},\"message\":{\"text\":\"ControlFlowNode for b\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/weak-sensitive-data-hashing\n文件路径: kcweb/common/autoload.py\n行号: 544\n\n漏洞描述:\n[Sensitive data (password)](1) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](2) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](3) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](4) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](5) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](6) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](7) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](8) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](9) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](10) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](11) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (password)](12) is used in a hashing algorithm (MD5) that is insecure for password hashing, since it is not a computationally expensive hash function.\n[Sensitive data (id)](13) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](14) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](15) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](16) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](17) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](18) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](19) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](20) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](21) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](22) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](23) is used in a hashing algorithm (MD5) that is insecure.\n[Sensitive data (id)](24) is used in a hashing algorithm (MD5) that is insecure.\n\n漏洞代码片段:\n代码 kcweb/common/autoload.py 片段（行 997 到 997 ）：\n    def uploadplug(self,plug,username=\'\',password=\'\',cli=False):\n\n\n代码 kcweb/common/autoload.py 片段（行 1006 到 1006 ）：\n            sign=md5(str(username)+str(timestamp)+md5(md5(password)))\n\n\n代码 kcweb/common/autoload.py 片段（行 535 到 535 ）：\ndef md5(strs):\n\n\n代码 kcweb/common/autoload.py 片段（行 543 到 543 ）：\n    b = strs.encode(encoding=\'utf-8\')\n\n\n代码 kcweb/common/autoload.py 片段（行 544 到 544 ）：\n    m.update(b)\n\n\n\n-------------------------------', '您好，根据您提供的审计提示，存在一个与密码相关的弱敏感数据哈希（py/weak-sensitive-data-hashing）问题。在kcweb/common/autoload.py文件中，有多个地方使用了MD5算法对敏感数据（包括密码和可能的用户ID）进行处理。MD5是一种较旧且不推荐用于密码存储的安全哈希函数，因为它不够安全，容易被暴力破解。\n\n以下是可能导致安全风险的代码片段：\n\n1. `uploadplug` 函数可能在密码处理中使用了MD5：\n   ```python\n   def uploadplug(plug, username=\'\', password=\'\', cli=False):\n       # ...\n       sign = md5(str(username) + str(timestamp) + md5(md5(password)))\n       # ...\n   ```\n\n2. 在其他地方，如计算签名时，也可能使用MD5对密码进行操作：\n   ```python\n   sign = md5(str(username) + str(timestamp) + md5(md5(password)))\n   ```\n\n3. `md5` 函数用于编码和哈希字符串：\n   ```python\n   def md5(strs):\n       b = strs.encode(encoding=\'utf-8\')\n       m.update(b)\n   ```\n\n为了修复这个漏洞，应考虑使用更安全的哈希函数，如bcrypt、scrypt或Argon2，它们设计用来抵抗暴力破解，并且具有足够的工作因子来增加计算成本。请尽快更新这些代码，以保护用户的密码和其他敏感信息。\n\n请确保更新后的代码符合现代密码学的最佳实践，例如使用密码盐（salt）和迭代次数，以增加安全性。同时，可能还需要审查其他地方是否也有类似的弱哈希用法。', '2024-06-16 14:11:20');
INSERT INTO `codeql` VALUES (46, 'py/hardcoded-credentials', 'This hardcoded value is [used as credentials](1).', '[{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":135,\"endColumn\":150}}}]', '[{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":135,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":55,\"endLine\":13,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for List\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":56,\"startColumn\":29,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":85,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":54,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":149,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":39,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":171,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for o\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":5,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":173,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":176,\"startColumn\":15,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":178,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":181,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":185,\"startColumn\":16,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":20,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":5,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for unique_match\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":190,\"startColumn\":12,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":20,\"endColumn\":48}},\"message\":{\"text\":\"ControlFlowNode for long_has_args()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":14,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opt\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":18,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":5,\"endColumn\":9}},\"message\":{\"text\":\"[post] ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":166,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":26,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for do_longs()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":97,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":22,\"endLine\":13,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":43,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for data\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":45,\"startColumn\":17,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for project\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":82,\"endColumn\":101}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":135,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":55,\"endLine\":13,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for List [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":56,\"startColumn\":29,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":87,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":87,\"startColumn\":20,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for list() [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":87,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":54,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":149,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":39,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":171,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":33,\"endColumn\":41}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for o\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":5,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":173,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":176,\"startColumn\":15,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":178,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":181,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":185,\"startColumn\":16,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":20,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for possibilities\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":5,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for unique_match\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":190,\"startColumn\":12,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":20,\"endColumn\":48}},\"message\":{\"text\":\"ControlFlowNode for long_has_args()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":14,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opt\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":18,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":5,\"endColumn\":9}},\"message\":{\"text\":\"[post] ControlFlowNode for opts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":166,\"startColumn\":12,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for opts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":166,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":26,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for do_longs() [Tuple element at index 0, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":13,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":97,\"startColumn\":12,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for opts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":97,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":22,\"endLine\":13,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute() [Tuple element at index 0, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":9,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for opts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":43,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for opts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":43,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for data\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":53,\"startColumn\":17,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":91,\"startColumn\":78,\"endColumn\":86}},\"message\":{\"text\":\"ControlFlowNode for username\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict [Dictionary element at key username]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par() [Dictionary element at key username]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par [Dictionary element at key username]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":82,\"endColumn\":89}},\"message\":{\"text\":\"ControlFlowNode for cmd_par [Dictionary element at key username]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":82,\"endColumn\":101}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":135,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":55,\"endLine\":13,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for List [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":56,\"startColumn\":29,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":85,\"startColumn\":21,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":85,\"startColumn\":20,\"endColumn\":30}},\"message\":{\"text\":\"ControlFlowNode for List [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":85,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":54,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":149,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":39,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":171,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":33,\"endColumn\":41}},\"message\":{\"text\":\"ControlFlowNode for longopts [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for o [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":22,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for o [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":21,\"endColumn\":63}},\"message\":{\"text\":\"ControlFlowNode for ListComp [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":5,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":173,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":176,\"startColumn\":15,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":178,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":181,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":185,\"startColumn\":16,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":20,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element, List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":20,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Subscript [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":5,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for unique_match [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":189,\"startColumn\":24,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for unique_match [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":189,\"startColumn\":24,\"endColumn\":41}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":189,\"startColumn\":9,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for unique_match\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":190,\"startColumn\":12,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":20,\"endColumn\":48}},\"message\":{\"text\":\"ControlFlowNode for long_has_args()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":14,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opt\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":18,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":5,\"endColumn\":9}},\"message\":{\"text\":\"[post] ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":166,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":26,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for do_longs()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":19,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for args\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":41,\"endColumn\":52}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":149,\"startColumn\":20,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for opt\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":155,\"startColumn\":14,\"endColumn\":20}},\"message\":{\"text\":\"ControlFlowNode for optarg\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":30,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for BoolExpr\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":18,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":5,\"endColumn\":9}},\"message\":{\"text\":\"[post] ControlFlowNode for opts [List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":166,\"startColumn\":12,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for opts [List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":166,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":26,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for do_longs() [Tuple element at index 0, List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":13,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opts [List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":97,\"startColumn\":12,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for opts [List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":97,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":22,\"endLine\":13,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute() [Tuple element at index 0, List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":9,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0, List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for opts [List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":43,\"startColumn\":21,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for opts [List element, Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":43,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for data [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":49,\"startColumn\":25,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for data [Tuple element at index 1]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":49,\"startColumn\":25,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":49,\"startColumn\":17,\"endColumn\":24}},\"message\":{\"text\":\"ControlFlowNode for modular\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":82,\"endColumn\":101}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}}]}]},{\"threadFlows\":[{\"locations\":[{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":135,\"endColumn\":150}},\"message\":{\"text\":\"ControlFlowNode for StringLiteral\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":55,\"endLine\":13,\"endColumn\":53}},\"message\":{\"text\":\"ControlFlowNode for List\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":56,\"startColumn\":29,\"endColumn\":37}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":87,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":87,\"startColumn\":20,\"endColumn\":34}},\"message\":{\"text\":\"ControlFlowNode for list()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":87,\"startColumn\":9,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":54,\"endColumn\":62}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":149,\"startColumn\":25,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":39,\"endColumn\":47}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":171,\"startColumn\":24,\"endColumn\":32}},\"message\":{\"text\":\"ControlFlowNode for longopts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":28,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for o\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":22,\"endColumn\":23}},\"message\":{\"text\":\"ControlFlowNode for o\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":21,\"endColumn\":63}},\"message\":{\"text\":\"ControlFlowNode for ListComp [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":172,\"startColumn\":5,\"endColumn\":18}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":173,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":176,\"startColumn\":15,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":178,\"startColumn\":23,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":181,\"startColumn\":12,\"endColumn\":25}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":185,\"startColumn\":16,\"endColumn\":29}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":20,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for possibilities [List element]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":20,\"endColumn\":36}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":186,\"startColumn\":5,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for unique_match\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":189,\"startColumn\":9,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for unique_match\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":190,\"startColumn\":12,\"endColumn\":33}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":20,\"endColumn\":48}},\"message\":{\"text\":\"ControlFlowNode for long_has_args()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":157,\"startColumn\":14,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opt\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":18,\"endColumn\":42}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":165,\"startColumn\":5,\"endColumn\":9}},\"message\":{\"text\":\"[post] ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":166,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":26,\"endColumn\":73}},\"message\":{\"text\":\"ControlFlowNode for do_longs()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":13,\"endColumn\":23}},\"message\":{\"text\":\"IterableElement\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":93,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":97,\"startColumn\":12,\"endColumn\":16}},\"message\":{\"text\":\"ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"file:\\/usr\\/lib\\/python3.10\\/getopt.py\",\"index\":14},\"region\":{\"startLine\":97,\"startColumn\":12,\"endColumn\":22}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":22,\"endLine\":13,\"endColumn\":54}},\"message\":{\"text\":\"ControlFlowNode for Attribute() [Tuple element at index 0]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":9,\"endColumn\":19}},\"message\":{\"text\":\"ControlFlowNode for Tuple [Tuple element at index 0]\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":12,\"startColumn\":9,\"endColumn\":13}},\"message\":{\"text\":\"ControlFlowNode for opts\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":43,\"startColumn\":13,\"endColumn\":17}},\"message\":{\"text\":\"ControlFlowNode for data\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":51,\"startColumn\":17,\"endColumn\":21}},\"message\":{\"text\":\"ControlFlowNode for plug\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":89,\"startColumn\":16,\"endLine\":94,\"endColumn\":10}},\"message\":{\"text\":\"ControlFlowNode for Dict\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":13,\"endColumn\":28}},\"message\":{\"text\":\"ControlFlowNode for __get_cmd_par()\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":96,\"startColumn\":5,\"endColumn\":12}},\"message\":{\"text\":\"ControlFlowNode for cmd_par\"}}},{\"location\":{\"physicalLocation\":{\"artifactLocation\":{\"uri\":\"kcweb\\/kcweb.py\",\"uriBaseId\":\"%SRCROOT%\",\"index\":7},\"region\":{\"startLine\":185,\"startColumn\":82,\"endColumn\":101}},\"message\":{\"text\":\"ControlFlowNode for Subscript\"}}}]}]}]', '2024-06-16 13:33:58', '2024-06-15 20:47:24', 0, '审计提示：\n-------------------------------\n漏洞类型: py/hardcoded-credentials\n文件路径: kcweb/kcweb.py\n行号: 12\n\n漏洞描述:\nThis hardcoded value is [used as credentials](1).\n\n漏洞代码片段:\n代码 kcweb/kcweb.py 片段（行 12 到 12 ）：\n        opts, args = getopt.getopt(sys.argv[1:], \"h\", [\"project=\",\"app=\",\"modular=\",\"plug=\",\"user=\",\"pwd=\",\"host=\",\"port=\",\"timeout=\",\"processcount=\",\n\n\n代码 kcweb/kcweb.py 片段（行 12 到 13 ）：\n        opts, args = getopt.getopt(sys.argv[1:], \"h\", [\"project=\",\"app=\",\"modular=\",\"plug=\",\"user=\",\"pwd=\",\"host=\",\"port=\",\"timeout=\",\"processcount=\",\n        \"install\",\"uninstall\",\"pack\",\"upload\",\"cli\"])\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 56 到 56 ）：\ndef getopt(args, shortopts, longopts = []):\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 85 到 85 ）：\n        longopts = [longopts]\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 93 到 93 ）：\n            opts, args = do_longs(opts, args[0][2:], longopts, args[1:])\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 149 到 149 ）：\ndef do_longs(opts, opt, longopts, args):\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 157 到 157 ）：\n    has_arg, opt = long_has_args(opt, longopts)\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 171 到 171 ）：\ndef long_has_args(opt, longopts):\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 172 到 172 ）：\n    possibilities = [o for o in longopts if o.startswith(opt)]\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 172 到 172 ）：\n    possibilities = [o for o in longopts if o.startswith(opt)]\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 173 到 173 ）：\n    if not possibilities:\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 176 到 176 ）：\n    if opt in possibilities:\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 178 到 178 ）：\n    elif opt + \'=\' in possibilities:\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 181 到 181 ）：\n    if len(possibilities) > 1:\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 185 到 185 ）：\n    assert len(possibilities) == 1\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 186 到 186 ）：\n    unique_match = possibilities[0]\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 186 到 186 ）：\n    unique_match = possibilities[0]\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 190 到 190 ）：\n    return has_arg, unique_match\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 157 到 157 ）：\n    has_arg, opt = long_has_args(opt, longopts)\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 157 到 157 ）：\n    has_arg, opt = long_has_args(opt, longopts)\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 165 到 165 ）：\n    opts.append((\'--\' + opt, optarg or \'\'))\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 165 到 165 ）：\n    opts.append((\'--\' + opt, optarg or \'\'))\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 166 到 166 ）：\n    return opts, args\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 93 到 93 ）：\n            opts, args = do_longs(opts, args[0][2:], longopts, args[1:])\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 93 到 93 ）：\n            opts, args = do_longs(opts, args[0][2:], longopts, args[1:])\n\n\n代码 file:/usr/lib/python3.10/getopt.py 片段（行 97 到 97 ）：\n    return opts, args\n\n\n代码 kcweb/kcweb.py 片段（行 12 到 13 ）：\n        opts, args = getopt.getopt(sys.argv[1:], \"h\", [\"project=\",\"app=\",\"modular=\",\"plug=\",\"user=\",\"pwd=\",\"host=\",\"port=\",\"timeout=\",\"processcount=\",\n        \"install\",\"uninstall\",\"pack\",\"upload\",\"cli\"])\n\n\n代码 kcweb/kcweb.py 片段（行 12 到 12 ）：\n        opts, args = getopt.getopt(sys.argv[1:], \"h\", [\"project=\",\"app=\",\"modular=\",\"plug=\",\"user=\",\"pwd=\",\"host=\",\"port=\",\"timeout=\",\"processcount=\",\n\n\n代码 kcweb/kcweb.py 片段（行 43 到 43 ）：\n        for data in opts:\n\n\n代码 kcweb/kcweb.py 片段（行 45 到 45 ）：\n                project=data[1]\n\n\n代码 kcweb/kcweb.py 片段（行 89 到 94 ）：\n        return {\n            \'server\':server,\n            \'project\':project,\'appname\':appname,\'modular\':modular,\'username\':username,\'password\':password,\'plug\':plug,\'host\':host,\'port\':port,\'timeout\':timeout,\'processcount\':processcount,\n            \'help\':help,\'install\':install,\'uninstall\':uninstall,\'pack\':pack,\'upload\':upload,\'cli\':cli,\n            \'index\':i\n        }\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 96 到 96 ）：\n    cmd_par=__get_cmd_par()\n\n\n代码 kcweb/kcweb.py 片段（行 185 到 185 ）：\n                        res=server.installplug(cmd_par[\'plug\'],cli=True,username=cmd_par[\'username\'])\n\n\n\n-------------------------------', '这段代码中提到的`hardcoded-credentials`漏洞意味着在kcweb.py文件的第12行，存在硬编码的凭据（如用户名和密码），这通常是不安全的做法，因为如果这些敏感信息被泄露，任何人都可以直接访问或使用这些设置。这种硬编码的用户和密码应该通过配置文件、环境变量或加密的方式进行管理，而不是直接写死在源代码中。\n\n具体到代码片段：\n\n```python\n        ...\n        \"user=\",\"pwd=\",\"host=\",\"port=\",\"timeout=\",\"processcount=\",\n        ...\n```\n\n这表明在命令行解析选项时，`user`和`pwd`参数没有通过安全的方式来传递，而是作为可选参数直接出现在命令行中。为了修复这个漏洞，你需要考虑以下步骤：\n\n1. 将这些凭据从命令行参数移到环境变量或者一个外部配置文件中。\n2. 在代码中读取环境变量或配置文件中的值，而不是直接硬编码。\n3. 使用适当的方法对读取的凭据进行加密存储和解密处理。\n\n例如，你可以使用`os.environ.get()`来获取环境变量中的值，或者使用Python的`configparser`模块来处理配置文件。\n\n请确保在生产环境中遵循最佳实践，以保护敏感信息的安全。', '2024-06-16 14:11:26');
INSERT INTO `codeql` VALUES (47, '', '', '', '', '2024-06-16 14:36:14', '2024-06-16 14:36:14', 0, '', '', '2024-06-16 14:36:14');

-- ----------------------------
-- Table structure for fortify
-- ----------------------------
DROP TABLE IF EXISTS `fortify`;
CREATE TABLE `fortify`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `project_id` int(11) NULL DEFAULT 1,
  `Category` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `Folder` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `Kingdom` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `Abstract` varchar(512) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `Friority` varchar(512) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `Primary` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL,
  `hash` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `git_addr` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `is_repair` int(11) NULL DEFAULT 0,
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE INDEX `project_id`(`project_id` ASC, `hash` ASC) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 122 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_bin ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of fortify
-- ----------------------------
INSERT INTO `fortify` VALUES (95, '2024-05-14 20:22:44', 2, 'Cross-Site Request Forgery', 'Low', 'Encapsulation', 'The form post at index.php line 84 must contain a user-specific secret in order to prevent an attacker from making unauthorized requests.', 'Low', '{\"FileName\":\"index.php\",\"FilePath\":\"app\\/admin\\/view\\/git_addr\\/index.php\",\"LineStart\":\"84\",\"Snippet\":\"\\n            <div class=\\\"modal-body\\\">\\n                <form action=\\\"{:URL(\'git_addr\\/_add\')}\\\" method=\\\"post\\\" enctype=\\\"multipart\\/form-data\\\">\\n                    <div class=\\\"mb-3\\\">\\n                        <label for=\\\"exampleFormControlTextarea1\\\" class=\\\"form-label\\\">\\u8f93\\u5165\\u4ed3\\u5e93\\u5730\\u5740<\\/label>\",\"TargetFunction\":\"null()\"}', '9bb1e8cf2d7f9bc7b8aa654d67cc6c19', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (96, '2024-05-14 20:22:44', 2, 'Cross-Site Request Forgery', 'Low', 'Encapsulation', 'The form post at add_git.php line 5 must contain a user-specific secret in order to prevent an attacker from making unauthorized requests.', 'Low', '{\"FileName\":\"add_git.php\",\"FilePath\":\"app\\/admin\\/view\\/project\\/add_git.php\",\"LineStart\":\"5\",\"Snippet\":\"        <div class=\\\"modal-content\\\">\\n            <div class=\\\"modal-body\\\">\\n                <form method=\\\"post\\\" action=\\\"<?php echo url(\'project\\/_add_domain\'); ?>\\\">\\n                    <div class=\\\"mb-3\\\">\\n                        <label class=\\\"form-label\\\">Git\\u5730\\u5740<\\/label>\",\"TargetFunction\":\"null()\"}', '3e26012ae4024423393875048b06c0c8', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (97, '2024-05-14 20:22:44', 2, 'Cross-Site Request Forgery', 'Low', 'Encapsulation', 'The form post at add_url.php line 5 must contain a user-specific secret in order to prevent an attacker from making unauthorized requests.', 'Low', '{\"FileName\":\"add_url.php\",\"FilePath\":\"app\\/admin\\/view\\/project\\/add_url.php\",\"LineStart\":\"5\",\"Snippet\":\"        <div class=\\\"modal-content\\\">\\n            <div class=\\\"modal-body\\\">\\n                <form method=\\\"post\\\" action=\\\"<?php echo url(\'project\\/_add_url\'); ?>\\\">\\n                    <div class=\\\"mb-3\\\">\\n                        <label class=\\\"form-label\\\">URL<\\/label>\",\"TargetFunction\":\"null()\"}', 'fdfe22a012938a5a561f3ce92e52c21d', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (98, '2024-05-14 20:22:44', 2, 'Cross-Site Request Forgery', 'Low', 'Encapsulation', 'The form post at batch_del.php line 1 must contain a user-specific secret in order to prevent an attacker from making unauthorized requests.', 'Low', '{\"FileName\":\"batch_del.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/batch_del.php\",\"LineStart\":\"1\",\"Snippet\":\"<form class=\\\"row g-3\\\" id=\\\"frmUpload\\\" action=\\\"\\\" method=\\\"post\\\"\\n      enctype=\\\"multipart\\/form-data\\\">\\n    <div class=\\\"col-auto\\\">\",\"TargetFunction\":\"null()\"}', 'a7c26d2f2473bbced5ec6b86d891f4b0', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (99, '2024-05-14 20:22:44', 2, 'Cross-Site Request Forgery', 'Low', 'Encapsulation', 'The form post at setting.php line 25 must contain a user-specific secret in order to prevent an attacker from making unauthorized requests.', 'Low', '{\"FileName\":\"setting.php\",\"FilePath\":\"app\\/admin\\/view\\/project\\/setting.php\",\"LineStart\":\"25\",\"Snippet\":\"                    <\\/div>\\n                    <div>\\n                        <form method=\\\"post\\\" action=\\\"{:URL(\'project\\/update_project_conf\')}\\\">\\n                            <div class=\\\"mb-3\\\">\\n                                <input type=\\\"text\\\" name=\\\"fortify_path\\\" class=\\\"form-control\\\"   placeholder=\\\"\\/opt\\/fortify\\/ (fortify \\u5b58\\u653e\\u8def\\u5f84)\\\">\",\"TargetFunction\":\"null()\"}', 'b69ab5ad4677b1bbc58323b46b3dc3cb', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (100, '2024-05-14 20:22:44', 2, 'Command Injection', 'Low', 'Input Validation and Representation', 'Line 51 in Gitaddr.php calls exec() to execute a command. This might allow an attacker to inject malicious commands.', 'Low', '{\"FileName\":\"Gitaddr.php\",\"FilePath\":\"app\\/model\\/Gitaddr.php\",\"LineStart\":\"51\",\"Snippet\":\"            $cmd = \\\"git install git -y\\\";\\n            echo $cmd . PHP_EOL;\\n            exec($cmd);\\n        }\\n    }\",\"TargetFunction\":\"exec(0)\"}', '0dc66121969548fe20e2e12a4ad7f8b6', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (101, '2024-05-14 20:22:44', 2, 'Command Injection', 'Low', 'Input Validation and Representation', 'Line 46 in Gitaddr.php calls exec() to execute a command. This might allow an attacker to inject malicious commands.', 'Low', '{\"FileName\":\"Gitaddr.php\",\"FilePath\":\"app\\/model\\/Gitaddr.php\",\"LineStart\":\"46\",\"Snippet\":\"    {\\n        $cmd = \\\"which git\\\";\\n        exec($cmd, $result);\\n\\n        if (empty($result)) {\",\"TargetFunction\":\"exec(0)\"}', '3dd72dfebca9d726b1fc278d544b72c6', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (102, '2024-05-14 20:22:44', 2, 'Command Injection', 'Low', 'Input Validation and Representation', 'Line 51 in Semgrep.php calls exec() to execute a command. This might allow an attacker to inject malicious commands.', 'Low', '{\"FileName\":\"Semgrep.php\",\"FilePath\":\"app\\/model\\/Semgrep.php\",\"LineStart\":\"51\",\"Snippet\":\"            print_r($cmd);\\n\\n            exec($cmd, $result);\\n            print_r($result);\\n        }\",\"TargetFunction\":\"exec(0)\"}', '8392fc7df98bd2cba7a47b90a6781879', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (103, '2024-05-14 20:22:44', 2, 'Command Injection', 'Low', 'Input Validation and Representation', 'Line 7 in common.php calls exec() to execute a command. This might allow an attacker to inject malicious commands.', 'Low', '{\"FileName\":\"common.php\",\"FilePath\":\"app\\/common.php\",\"LineStart\":\"7\",\"Snippet\":\"function execLog($cmd){\\n    echo $cmd.PHP_EOL;\\n    return exec($cmd);\\n}\",\"TargetFunction\":\"exec(0)\"}', '7726f8f2f42ae3e547895a7971c3fbce', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (104, '2024-05-14 20:22:44', 2, 'Command Injection', 'Low', 'Input Validation and Representation', 'Line 33 in Gitaddr.php calls exec() to execute a command. This might allow an attacker to inject malicious commands.', 'Low', '{\"FileName\":\"Gitaddr.php\",\"FilePath\":\"app\\/model\\/Gitaddr.php\",\"LineStart\":\"33\",\"Snippet\":\"\\n        $cmd = \\\"cd \\/data\\/code && git clone --depth=1 {$gitAddr} $project_name\\\";\\n        exec($cmd);\\n\\n        $codePath = \\\"\\/data\\/code\\/{$project_name}\\\";\",\"TargetFunction\":\"exec(0)\"}', '351b5b718844f47585a1355bde209cce', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (105, '2024-05-14 20:22:44', 2, 'Weak Cryptographic Hash', 'Low', 'Security Features', 'Weak cryptographic hashes cannot guarantee data integrity and should not be used in security-critical contexts.', 'Low', '{\"FileName\":\"Fortify.php\",\"FilePath\":\"app\\/model\\/Fortify.php\",\"LineStart\":\"41\",\"Snippet\":\"    {\\n        $codePath = $codeInfo[\'code_path\'];\\n        $buildId = md5($codePath);\\n\\n        if (file_exists($outPath)) {\",\"TargetFunction\":\"md5()\"}', '2fdeab5ea4b3acdb36683621d15b379b', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (106, '2024-05-14 20:22:44', 2, 'Weak Cryptographic Hash', 'Low', 'Security Features', 'Weak cryptographic hashes cannot guarantee data integrity and should not be used in security-critical contexts.', 'Low', '{\"FileName\":\"Fortify.php\",\"FilePath\":\"app\\/model\\/Fortify.php\",\"LineStart\":\"113\",\"Snippet\":\"                    $v = is_string($v) ? $v : json_encode($v);\\n                }\\n                $val[\'hash\'] = md5($val[\'Primary\']);\\n                $val[\'git_addr\'] = $git_addr;\\n                $data[] = $val;\",\"TargetFunction\":\"md5()\"}', '2f4970c9bb992d190c1365e4d096e894', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (107, '2024-05-14 20:22:44', 2, 'Weak Cryptographic Hash', 'Low', 'Security Features', 'Weak cryptographic hashes cannot guarantee data integrity and should not be used in security-critical contexts.', 'Low', '{\"FileName\":\"Semgrep.php\",\"FilePath\":\"app\\/model\\/Semgrep.php\",\"LineStart\":\"44\",\"Snippet\":\"            echo \\\"\\u4ee3\\u7801\\u76ee\\u5f55\\u4e0d\\u5b58\\u5728:{$codePath} , \\u5373\\u5c06\\u81ea\\u52a8\\u4e0b\\u8f7d... \\\\n\\\";\\n        }\\n        $hash = md5($codePath);\\n        $outFile = \\\"\\/tmp\\/{$hash}.json\\\";\\n        if (!file_exists($outFile)) {\",\"TargetFunction\":\"md5()\"}', '480b7bed9baa417b1a2991226ae21512', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (108, '2024-05-14 20:22:44', 2, 'Weak Cryptographic Hash', 'Low', 'Security Features', 'Weak cryptographic hashes cannot guarantee data integrity and should not be used in security-critical contexts.', 'Low', '{\"FileName\":\"Fortify.php\",\"FilePath\":\"app\\/model\\/Fortify.php\",\"LineStart\":\"23\",\"Snippet\":\"        foreach ($list as $item) {\\n\\n            $outPath = \\\"\\/tmp\\/fortify_\\\" . md5($item[\'code_path\']);\\n            $ret = $obj->execTool($item, $outPath);\\n\",\"TargetFunction\":\"md5()\"}', '65cc5c4b66a9c1eb26957d5dc15780f1', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (109, '2024-05-14 20:22:44', 2, 'Cross-Site Scripting: Reflected', 'Critical', 'Input Validation and Representation', 'Line 48 of report.php sends unvalidated data to a web browser, which can result in the browser executing malicious code.', 'Critical', '{\"FileName\":\"report.php\",\"FilePath\":\"app\\/admin\\/view\\/fortify\\/report.php\",\"LineStart\":\"48\",\"Snippet\":\"                    <a type=\\\"button\\\"\\n                       class=\\\"btn btn-outline-primary  <?php echo isset($param[\'Folder\']) ? \'\' : \'active\' ?> \\\"\\n                       href=\\\"<?php echo str_replace(\'Folder=\', \'\', $_SERVER[\'REQUEST_URI\']) ?>\\\">\\u5168\\u90e8<\\/a>\\n                    <a type=\\\"button\\\"\\n                       class=\\\"btn btn-outline-primary <?php echo isset($param[\'Folder\']) && $param[\'Folder\'] == \'Critical\' ? \'active\' : \'\' ?>\\\"\",\"TargetFunction\":\"builtin_echo()\"}', '22cee6f86f52d611c6afc100d6b75b4e', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (110, '2024-05-14 20:22:44', 2, 'Cross-Site Scripting: Reflected', 'Critical', 'Input Validation and Representation', 'Line 36 of report.php sends unvalidated data to a web browser, which can result in the browser executing malicious code.', 'Critical', '{\"FileName\":\"report.php\",\"FilePath\":\"app\\/admin\\/view\\/fortify\\/report.php\",\"LineStart\":\"36\",\"Snippet\":\"                    <a type=\\\"button\\\"\\n                       class=\\\"btn btn-outline-primary <?php echo isset($param[\'is_repair\']) ? \'\' : \'active\' ?> \\\"\\n                       href=\\\"<?php echo str_replace(\'is_repair=\', \'\', $_SERVER[\'REQUEST_URI\']) ?>\\\">\\u5168\\u90e8<\\/a>\\n                    <a type=\\\"button\\\"\\n                       class=\\\"btn btn-outline-primary  <?php echo isset($param[\'is_repair\']) && $param[\'is_repair\'] == 0 ? \'active\' : \'\' ?>\\\"\",\"TargetFunction\":\"builtin_echo()\"}', '121f5db6d549190b7ba0ae85e74162f3', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (111, '2024-05-14 20:22:44', 2, 'Cross-Site Scripting: Reflected', 'Critical', 'Input Validation and Representation', 'Line 32 of search.php sends unvalidated data to a web browser, which can result in the browser executing malicious code.', 'Critical', '{\"FileName\":\"search.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/search.php\",\"LineStart\":\"32\",\"Snippet\":\"                            <div class=\\\"col-auto\\\">\\n                                <input type=\\\"{$inputInfo[\'type\']}\\\" class=\\\"form-control\\\" name=\\\"{$inputInfo[\'name\']}\\\"\\n                                       value=\\\"<?php echo $inputInfo[\'value\'] ?? strip_tags($_GET[\'search\'] ?? \'\') ?>\\\"\\n                                       placeholder=\\\"{$inputInfo[\'placeholder\']}\\\">\\n                            <\\/div>\",\"TargetFunction\":\"builtin_echo()\"}', '4e0471b6b8de6eb82c3e12351ef32246', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (112, '2024-05-14 20:22:44', 2, 'Hardcoded Domain in HTML', 'Low', 'Encapsulation', 'The file top.php references a script using a hardcoded domain name on line 11. If attackers compromise the domain, they will have malicious code on this page.', 'Low', '{\"FileName\":\"top.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/top.php\",\"LineStart\":\"11\",\"Snippet\":\"    <link href=\\\"\\/static\\/css\\/qingscan.css\\\" rel=\\\"stylesheet\\\">\\n    <script src=\\\"https:\\/\\/cdn.jsdelivr.net\\/npm\\/@popperjs\\/core@2.6.0\\/dist\\/umd\\/popper.min.js\\\"><\\/script>\\n    <script crossorigin=\\\"anonymous\\\" src=\\\"https:\\/\\/lib.baomitu.com\\/twitter-bootstrap\\/5.2.3\\/js\\/bootstrap.min.js\\\"><\\/script>\\n    <meta name=\\\"keywords\\\" content=\\\"\\\">\\n    <meta name=\\\"description\\\"\",\"TargetFunction\":\"null()\"}', '94751bbc2888ffd8da1f6b5435032405', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (113, '2024-05-14 20:22:44', 2, 'Hardcoded Domain in HTML', 'Low', 'Encapsulation', 'The file top.php references a script using a hardcoded domain name on line 10. If attackers compromise the domain, they will have malicious code on this page.', 'Low', '{\"FileName\":\"top.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/top.php\",\"LineStart\":\"10\",\"Snippet\":\"    <link href=\\\"https:\\/\\/cdn.jsdelivr.net\\/npm\\/bootstrap@5.0.0-beta1\\/dist\\/css\\/bootstrap.min.css\\\" rel=\\\"stylesheet\\\">\\n    <link href=\\\"\\/static\\/css\\/qingscan.css\\\" rel=\\\"stylesheet\\\">\\n    <script src=\\\"https:\\/\\/cdn.jsdelivr.net\\/npm\\/@popperjs\\/core@2.6.0\\/dist\\/umd\\/popper.min.js\\\"><\\/script>\\n    <script crossorigin=\\\"anonymous\\\" src=\\\"https:\\/\\/lib.baomitu.com\\/twitter-bootstrap\\/5.2.3\\/js\\/bootstrap.min.js\\\"><\\/script>\\n    <meta name=\\\"keywords\\\" content=\\\"\\\">\",\"TargetFunction\":\"null()\"}', 'a6b2b7febeed0f25f3a40f0468cdddc7', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (114, '2024-05-14 20:22:44', 2, 'Hardcoded Domain in HTML', 'Low', 'Encapsulation', 'The file top.php references a script using a hardcoded domain name on line 5. If attackers compromise the domain, they will have malicious code on this page.', 'Low', '{\"FileName\":\"top.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/top.php\",\"LineStart\":\"5\",\"Snippet\":\"    <title><?php echo $title ?? \'Swallow \\u4ee3\\u7801\\u5ba1\\u8ba1\\u7cfb\\u7edf\' ?><\\/title>\\n    <link rel=\\\"shortcut icon\\\" href=\\\"\\/static\\/images\\/logo_blue.png\\\" type=\\\"image\\/x-icon\\\"\\/>\\n    <script crossorigin=\\\"anonymous\\\" src=\\\"https:\\/\\/lib.baomitu.com\\/jquery\\/2.2.4\\/jquery.min.js\\\"><\\/script>\\n    <link crossorigin=\\\"anonymous\\\" href=\\\"https:\\/\\/lib.baomitu.com\\/twitter-bootstrap\\/5.2.3\\/css\\/bootstrap.min.css\\\"\\n          rel=\\\"stylesheet\\\">\",\"TargetFunction\":\"null()\"}', '19a525afceb6e6e37a9191e3a05e20b9', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (115, '2024-05-14 20:22:44', 2, 'Hidden Field', 'Low', 'Encapsulation', 'A hidden form field is used in index.php on line 61.', 'Low', '{\"FileName\":\"index.php\",\"FilePath\":\"app\\/admin\\/view\\/index\\/index.php\",\"LineStart\":\"61\",\"Snippet\":\"        <\\/div>\\n    <\\/div>\\n    <input type=\\\"hidden\\\" id=\\\"to_examine_url\\\" value=\\\"<?php echo url(\'index\\/add\') ?>\\\">\\n    {include file=\'index\\/add_custom\' \\/}\\n    {include file=\'public\\/fenye\' \\/}\",\"TargetFunction\":\"null()\"}', '798d7eaf561c3c12f29381b4b009508c', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (116, '2024-05-14 20:22:44', 2, 'Hidden Field', 'Low', 'Encapsulation', 'A hidden form field is used in form.php on line 14.', 'Low', '{\"FileName\":\"form.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/form.php\",\"LineStart\":\"14\",\"Snippet\":\"        <?php foreach ($formList as $value) { ?>\\n            <?php if (in_array($value[\'type\'], [\'hidden\'])) { ?>\\n                <input type=\\\"hidden\\\" name=\\\"{$value[\'name\']}\\\" class=\\\"form-control\\\" value=\\\"{$value[\'value\']}\\\"\\n                       placeholder=\\\"{$value[\'placeholder\']??\'\'}\\\"\\n                    <?php echo $value[\'required\'] ? \'required\' : \'\'; ?>>\",\"TargetFunction\":\"null()\"}', '8a51d1ede64282ba83cf3983dc5c8e20', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (117, '2024-05-14 20:22:44', 2, 'Hidden Field', 'Low', 'Encapsulation', 'A hidden form field is used in to_examine.php on line 1.', 'Low', '{\"FileName\":\"to_examine.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/to_examine.php\",\"LineStart\":\"1\",\"Snippet\":\"<input type=\\\"hidden\\\" id=\\\"check_status\\\" value=\\\"0\\\">\\n<div class=\\\"modal fade\\\" id=\\\"exampleModal\\\" tabindex=\\\"-1\\\" role=\\\"dialog\\\" aria-labelledby=\\\"exampleModalLabel\\\">\\n    <div class=\\\"modal-dialog\\\" role=\\\"document\\\">\",\"TargetFunction\":\"null()\"}', '2957dcd8ffff9b95faa4545c902ad924', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (118, '2024-05-14 20:22:44', 2, 'Insecure Transport: External Link', 'Medium', 'Security Features', 'The file setting.php on line 46 links to a third-party site over an unencrypted channel.', 'Medium', '{\"FileName\":\"setting.php\",\"FilePath\":\"app\\/admin\\/view\\/project\\/setting.php\",\"LineStart\":\"46\",\"Snippet\":\"                                                                         href=\\\"https:\\/\\/www.murphysec.com\\/usr\\/token\\\">\\u70b9\\u6b64<\\/a>\\n                            \\u751f\\u6210<\\/p>\\n                        <p>3. \\u5e95\\u5c42\\u4f7f\\u7528\\u873b\\u8713\\u5f00\\u53d1,\\u9700\\u8981\\u4f60\\u6dfb\\u52a0\\u8282\\u70b9,\\u5e76\\u514b\\u9686\\u5bf9\\u5e94\\u7684\\u5de5\\u4f5c\\u6d41 <a target=\\\"_blank\\\"\\n                                                                                    href=\\\"http:\\/\\/qingting.starcross.cn\\/scenario\\/detail?id=2084\\\">\\u70b9\\u6b64<\\/a>\\n                            \\u6dfb\\u52a0<\\/p>\",\"TargetFunction\":\"null()\"}', '327810ea4665d906def5d937b2990b30', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (119, '2024-05-14 20:22:44', 2, 'Often Misused: File Upload', 'Medium', 'API Abuse', 'Permitting users to upload files can allow attackers to inject dangerous content or malicious code to run on the server.', 'Medium', '{\"FileName\":\"form.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/form.php\",\"LineStart\":\"62\",\"Snippet\":\"                <div class=\\\"mb-3\\\">\\n                    <label for=\\\"formFile\\\" class=\\\"form-label\\\">{$value[\'label\']}<\\/label>\\n                    <input class=\\\"form-control\\\" name=\\\"target_file\\\" type=\\\"file\\\" id=\\\"formFile\\\">\\n                <\\/div>\\n            <?php } ?>\",\"TargetFunction\":\"null()\"}', '00a6918a53340ffdbd8d3cafea5d4bd8', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `fortify` VALUES (121, '2024-05-14 20:22:44', 2, 'Privacy Violation: Autocomplete', 'High', 'Security Features', 'The form in login.php uses autocompletion on line 87, which allows some browsers to retain sensitive information in their history.', 'High', '{\"FileName\":\"login.php\",\"FilePath\":\"app\\/admin\\/view\\/public\\/login.php\",\"LineStart\":\"87\",\"Snippet\":\"    <input type=\\\"email\\\" id=\\\"inputEmail\\\" class=\\\"form-control\\\" placeholder=\\\"\\u90ae\\u4ef6\\u5730\\u5740\\\" required autofocus>\\n    <label for=\\\"inputPassword\\\" class=\\\"sr-only\\\">\\u5bc6\\u7801<\\/label>\\n    <input type=\\\"password\\\" id=\\\"inputPassword\\\" class=\\\"form-control\\\" placeholder=\\\"\\u5bc6\\u7801\\\" required>\\n    <div class=\\\"checkbox mb-3\\\">\\n        <label>\",\"TargetFunction\":\"null()\"}', 'd9ecf295031a14307d2cef9226b20125', 'https://gitee.com/songboy/swallow.git', 0);

-- ----------------------------
-- Table structure for semgrep
-- ----------------------------
DROP TABLE IF EXISTS `semgrep`;
CREATE TABLE `semgrep`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `project_id` int(11) NULL DEFAULT 1,
  `check_id` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `end` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `extra` text CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL,
  `path` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `start` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `git_addr` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `is_repair` int(11) NULL DEFAULT 0,
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE INDEX `un_vul`(`project_id` ASC, `path` ASC, `start` ASC, `end` ASC, `check_id` ASC) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 28 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_bin ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of semgrep
-- ----------------------------
INSERT INTO `semgrep` VALUES (13, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":22,\"line\":7,\"offset\":98}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"9bbab89f80b9eef592b0de15a0808c5b30e669cfbcaf459e62919381b54330af210acdcaa174afd65ff0e8d6a94bf524048ed826439faa1b7652a76575acb6cc_0\",\"is_ignored\":false,\"lines\":\"    return exec($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"exec\",\"end\":{\"col\":16,\"line\":7,\"offset\":92},\"start\":{\"col\":12,\"line\":7,\"offset\":88}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/common.php', '{\"col\":5,\"line\":7,\"offset\":81}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (14, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":27,\"line\":61,\"offset\":1810}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"311a3a0ce5a2af9292ab4d6e15fa6cd910ef318f2759c60d0f9dad91653fbcf3198e94db4d0e1b5983ef291fe9e3cd4679596ae791eb1d55d02a0a9d2aae5048_0\",\"is_ignored\":false,\"lines\":\"            execLog($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"execLog\",\"end\":{\"col\":20,\"line\":61,\"offset\":1803},\"start\":{\"col\":13,\"line\":61,\"offset\":1796}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Fortify.php', '{\"col\":13,\"line\":61,\"offset\":1796}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (15, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":27,\"line\":63,\"offset\":1974}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"311a3a0ce5a2af9292ab4d6e15fa6cd910ef318f2759c60d0f9dad91653fbcf3198e94db4d0e1b5983ef291fe9e3cd4679596ae791eb1d55d02a0a9d2aae5048_1\",\"is_ignored\":false,\"lines\":\"            execLog($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"execLog\",\"end\":{\"col\":20,\"line\":63,\"offset\":1967},\"start\":{\"col\":13,\"line\":63,\"offset\":1960}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Fortify.php', '{\"col\":13,\"line\":63,\"offset\":1960}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (16, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":27,\"line\":67,\"offset\":2250}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"311a3a0ce5a2af9292ab4d6e15fa6cd910ef318f2759c60d0f9dad91653fbcf3198e94db4d0e1b5983ef291fe9e3cd4679596ae791eb1d55d02a0a9d2aae5048_2\",\"is_ignored\":false,\"lines\":\"            execLog($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"execLog\",\"end\":{\"col\":20,\"line\":67,\"offset\":2243},\"start\":{\"col\":13,\"line\":67,\"offset\":2236}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Fortify.php', '{\"col\":13,\"line\":67,\"offset\":2236}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (17, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":27,\"line\":74,\"offset\":2590}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"311a3a0ce5a2af9292ab4d6e15fa6cd910ef318f2759c60d0f9dad91653fbcf3198e94db4d0e1b5983ef291fe9e3cd4679596ae791eb1d55d02a0a9d2aae5048_3\",\"is_ignored\":false,\"lines\":\"            execLog($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"execLog\",\"end\":{\"col\":20,\"line\":74,\"offset\":2583},\"start\":{\"col\":13,\"line\":74,\"offset\":2576}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Fortify.php', '{\"col\":13,\"line\":74,\"offset\":2576}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (18, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":20,\"line\":33,\"offset\":753}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"97ad25bdf8a98b684b2807673114ef1f462a77203c942bd9613c2926e5d98500bea62f066c25b4ff73b7bbdf665451230c2542b8b286da50c52e2a6cf80ce515_0\",\"is_ignored\":false,\"lines\":\"        exec($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"exec\",\"end\":{\"col\":13,\"line\":33,\"offset\":746},\"start\":{\"col\":9,\"line\":33,\"offset\":742}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/GitAddr.php', '{\"col\":9,\"line\":33,\"offset\":742}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (19, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":20,\"line\":56,\"offset\":1539}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"08c7091d898138a5e9c1f92aa9282c2d71f057428d0b5fd2bcbc94b98298c7d2ce493e5e219261f2d96959d96ba542fc71fa376e58622afa11b3537566c39eb0_0\",\"is_ignored\":false,\"lines\":\"        exec($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"exec\",\"end\":{\"col\":13,\"line\":56,\"offset\":1532},\"start\":{\"col\":9,\"line\":56,\"offset\":1528}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Hema.php', '{\"col\":9,\"line\":56,\"offset\":1528}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (20, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":20,\"line\":116,\"offset\":3369}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"08c7091d898138a5e9c1f92aa9282c2d71f057428d0b5fd2bcbc94b98298c7d2ce493e5e219261f2d96959d96ba542fc71fa376e58622afa11b3537566c39eb0_1\",\"is_ignored\":false,\"lines\":\"        exec($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"exec\",\"end\":{\"col\":13,\"line\":116,\"offset\":3362},\"start\":{\"col\":9,\"line\":116,\"offset\":3358}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Hema.php', '{\"col\":9,\"line\":116,\"offset\":3358}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (21, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":20,\"line\":119,\"offset\":3458}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"08c7091d898138a5e9c1f92aa9282c2d71f057428d0b5fd2bcbc94b98298c7d2ce493e5e219261f2d96959d96ba542fc71fa376e58622afa11b3537566c39eb0_2\",\"is_ignored\":false,\"lines\":\"        exec($cmd);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"exec\",\"end\":{\"col\":13,\"line\":119,\"offset\":3451},\"start\":{\"col\":9,\"line\":119,\"offset\":3447}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Hema.php', '{\"col\":9,\"line\":119,\"offset\":3447}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (22, '2024-05-14 20:20:33', 2, 'php.lang.security.exec-use.exec-use', '{\"col\":33,\"line\":53,\"offset\":1550}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"06f3a3bb166418604fcc97988cf541c9281cdeb835bd2728dd1d56df5175a7e16ad5a8a4ead27d2026ff38b036e0b5113761cfb083cc3f4cf65d5fb0186d7821_0\",\"is_ignored\":false,\"lines\":\"            exec($cmd, $result);\",\"message\":\"Executing non-constant commands. This can lead to command injection.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-94: Improper Control of Generation of Code (\'Code Injection\')\"],\"cwe2022-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A03:2021 - Injection\"],\"references\":[\"https:\\/\\/github.com\\/FloeDesignTechnologies\\/phpcs-security-audit\\/blob\\/master\\/Security\\/Sniffs\\/BadFunctions\\/SystemExecFunctionsSniff.php\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":9391,\"rule_id\":\"qNUjye\",\"rv_id\":110038,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/BjTXrZP\\/php.lang.security.exec-use.exec-use\",\"version_id\":\"BjTXrZP\"}},\"shortlink\":\"https:\\/\\/sg.run\\/5Q1j\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.exec-use.exec-use\",\"subcategory\":[\"audit\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Code Injection\"]},\"metavars\":{\"$FUNC\":{\"abstract_content\":\"exec\",\"end\":{\"col\":17,\"line\":53,\"offset\":1534},\"start\":{\"col\":13,\"line\":53,\"offset\":1530}}},\"severity\":\"ERROR\",\"validation_state\":\"NO_VALIDATOR\"}', 'app/model/Semgrep.php', '{\"col\":13,\"line\":53,\"offset\":1530}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (23, '2024-05-14 20:20:33', 2, 'yaml.docker-compose.security.no-new-privileges.no-new-privileges', '{\"col\":8,\"line\":3,\"offset\":34}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"611af8be0e394de2cce2935f53f8b10052055cd85ae14962bc12119b2e0ef2ecb4e9911490d76aa06d6141d5e228e8c352d7a12351e88b169cbc88f2c7db713b_0\",\"is_ignored\":false,\"lines\":\"  mysql:\",\"message\":\"Service \'mysql\' allows for privilege escalation via setuid or setgid binaries. Add \'no-new-privileges:true\' in \'security_opt\' to prevent this.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-732: Incorrect Permission Assignment for Critical Resource\"],\"cwe2021-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A05:2021 - Security Misconfiguration\",\"A06:2017 - Security Misconfiguration\"],\"references\":[\"https:\\/\\/raesene.github.io\\/blog\\/2019\\/06\\/01\\/docker-capabilities-and-no-new-privs\\/\",\"https:\\/\\/www.kernel.org\\/doc\\/Documentation\\/prctl\\/no_new_privs.txt\",\"https:\\/\\/cheatsheetseries.owasp.org\\/cheatsheets\\/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":10054,\"rule_id\":\"qNUoWr\",\"rv_id\":111110,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/qkT2BLp\\/yaml.docker-compose.security.no-new-privileges.no-new-privileges\",\"version_id\":\"qkT2BLp\"}},\"shortlink\":\"https:\\/\\/sg.run\\/0n8q\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/yaml.docker-compose.security.no-new-privileges.no-new-privileges\",\"subcategory\":[\"audit\"],\"technology\":[\"docker-compose\"],\"vulnerability_class\":[\"Improper Authorization\"]},\"metavars\":{\"$SERVICE\":{\"abstract_content\":\"mysql\",\"end\":{\"col\":8,\"line\":3,\"offset\":34},\"start\":{\"col\":3,\"line\":3,\"offset\":29}}},\"severity\":\"WARNING\",\"validation_state\":\"NO_VALIDATOR\"}', 'docker-compose.yaml', '{\"col\":3,\"line\":3,\"offset\":29}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (24, '2024-05-14 20:20:33', 2, 'yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service', '{\"col\":8,\"line\":3,\"offset\":34}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"64ea96d11350f6263b10938470d07fb4747246f7d1948ee331b86ac36670b23ca0c54533d518425900de4a61d4d1571fd05e5ef9f391cacf994fd3cf7171bacc_0\",\"is_ignored\":false,\"lines\":\"  mysql:\",\"message\":\"Service \'mysql\' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add \'read_only: true\' to this service to prevent this.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-732: Incorrect Permission Assignment for Critical Resource\"],\"cwe2021-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A05:2021 - Security Misconfiguration\",\"A06:2017 - Security Misconfiguration\"],\"references\":[\"https:\\/\\/docs.docker.com\\/compose\\/compose-file\\/compose-file-v3\\/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir\",\"https:\\/\\/blog.atomist.com\\/security-of-docker-kubernetes\\/\",\"https:\\/\\/cheatsheetseries.owasp.org\\/cheatsheets\\/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":10132,\"rule_id\":\"v8U5vN\",\"rv_id\":111114,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/o5Tg9ob\\/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service\",\"version_id\":\"o5Tg9ob\"}},\"shortlink\":\"https:\\/\\/sg.run\\/e4JE\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service\",\"subcategory\":[\"audit\"],\"technology\":[\"docker-compose\"],\"vulnerability_class\":[\"Improper Authorization\"]},\"metavars\":{\"$SERVICE\":{\"abstract_content\":\"mysql\",\"end\":{\"col\":8,\"line\":3,\"offset\":34},\"start\":{\"col\":3,\"line\":3,\"offset\":29}}},\"severity\":\"WARNING\",\"validation_state\":\"NO_VALIDATOR\"}', 'docker-compose.yaml', '{\"col\":3,\"line\":3,\"offset\":29}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (25, '2024-05-14 20:20:33', 2, 'yaml.docker-compose.security.no-new-privileges.no-new-privileges', '{\"col\":10,\"line\":16,\"offset\":419}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"2a865ffa290f437284d424a631d81b0466d2e05502beb8b555cabfb38e7389b82cbbee4dffd6ce8e2c1787332ae84a74d6dc28f94032affc757361a064d2719e_0\",\"is_ignored\":false,\"lines\":\"  swallow:\",\"message\":\"Service \'swallow\' allows for privilege escalation via setuid or setgid binaries. Add \'no-new-privileges:true\' in \'security_opt\' to prevent this.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-732: Incorrect Permission Assignment for Critical Resource\"],\"cwe2021-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A05:2021 - Security Misconfiguration\",\"A06:2017 - Security Misconfiguration\"],\"references\":[\"https:\\/\\/raesene.github.io\\/blog\\/2019\\/06\\/01\\/docker-capabilities-and-no-new-privs\\/\",\"https:\\/\\/www.kernel.org\\/doc\\/Documentation\\/prctl\\/no_new_privs.txt\",\"https:\\/\\/cheatsheetseries.owasp.org\\/cheatsheets\\/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":10054,\"rule_id\":\"qNUoWr\",\"rv_id\":111110,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/qkT2BLp\\/yaml.docker-compose.security.no-new-privileges.no-new-privileges\",\"version_id\":\"qkT2BLp\"}},\"shortlink\":\"https:\\/\\/sg.run\\/0n8q\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/yaml.docker-compose.security.no-new-privileges.no-new-privileges\",\"subcategory\":[\"audit\"],\"technology\":[\"docker-compose\"],\"vulnerability_class\":[\"Improper Authorization\"]},\"metavars\":{\"$SERVICE\":{\"abstract_content\":\"swallow\",\"end\":{\"col\":10,\"line\":16,\"offset\":419},\"start\":{\"col\":3,\"line\":16,\"offset\":412}}},\"severity\":\"WARNING\",\"validation_state\":\"NO_VALIDATOR\"}', 'docker-compose.yaml', '{\"col\":3,\"line\":16,\"offset\":412}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (26, '2024-05-14 20:20:33', 2, 'yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service', '{\"col\":10,\"line\":16,\"offset\":419}', '{\"engine_kind\":\"OSS\",\"fingerprint\":\"3a426df5699afcdbe36c8dc418b28010c23a174edb7091520ae940bc75afcb0199143c2eb6a0bea237bf6f0e33b8aa2d54ce08f3bbcc79e66eef2340ce494dd1_0\",\"is_ignored\":false,\"lines\":\"  swallow:\",\"message\":\"Service \'swallow\' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add \'read_only: true\' to this service to prevent this.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"LOW\",\"cwe\":[\"CWE-732: Incorrect Permission Assignment for Critical Resource\"],\"cwe2021-top25\":true,\"impact\":\"HIGH\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"LOW\",\"owasp\":[\"A05:2021 - Security Misconfiguration\",\"A06:2017 - Security Misconfiguration\"],\"references\":[\"https:\\/\\/docs.docker.com\\/compose\\/compose-file\\/compose-file-v3\\/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir\",\"https:\\/\\/blog.atomist.com\\/security-of-docker-kubernetes\\/\",\"https:\\/\\/cheatsheetseries.owasp.org\\/cheatsheets\\/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":10132,\"rule_id\":\"v8U5vN\",\"rv_id\":111114,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/o5Tg9ob\\/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service\",\"version_id\":\"o5Tg9ob\"}},\"shortlink\":\"https:\\/\\/sg.run\\/e4JE\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service\",\"subcategory\":[\"audit\"],\"technology\":[\"docker-compose\"],\"vulnerability_class\":[\"Improper Authorization\"]},\"metavars\":{\"$SERVICE\":{\"abstract_content\":\"swallow\",\"end\":{\"col\":10,\"line\":16,\"offset\":419},\"start\":{\"col\":3,\"line\":16,\"offset\":412}}},\"severity\":\"WARNING\",\"validation_state\":\"NO_VALIDATOR\"}', 'docker-compose.yaml', '{\"col\":3,\"line\":16,\"offset\":412}', 'https://gitee.com/songboy/swallow.git', 0);
INSERT INTO `semgrep` VALUES (27, '2024-05-14 20:20:33', 2, 'php.lang.security.injection.tainted-filename.tainted-filename', '{\"col\":64,\"line\":13,\"offset\":666}', '{\"dataflow_trace\":{\"intermediate_vars\":[],\"taint_sink\":[\"CliLoc\",[{\"end\":{\"col\":64,\"line\":13,\"offset\":666},\"path\":\"public\\/router.php\",\"start\":{\"col\":13,\"line\":13,\"offset\":615}},\"$_SERVER[\\\"DOCUMENT_ROOT\\\"] . $_SERVER[\\\"SCRIPT_NAME\\\"]\"]],\"taint_source\":[\"CliLoc\",[{\"end\":{\"col\":21,\"line\":13,\"offset\":623},\"path\":\"public\\/router.php\",\"start\":{\"col\":13,\"line\":13,\"offset\":615}},\"$_SERVER\"]]},\"engine_kind\":\"OSS\",\"fingerprint\":\"08a7872007b140e07cb6c3699f11326367ea85943d7b41cbd972bffff446482a48658933d789f05a7da3b5327b0f4bd5edd1a425f336156a67404ba18d5f3509_0\",\"is_ignored\":false,\"lines\":\"if (is_file($_SERVER[\\\"DOCUMENT_ROOT\\\"] . $_SERVER[\\\"SCRIPT_NAME\\\"])) {\",\"message\":\"File name based on user input risks server-side request forgery.\",\"metadata\":{\"category\":\"security\",\"confidence\":\"MEDIUM\",\"cwe\":[\"CWE-918: Server-Side Request Forgery (SSRF)\"],\"cwe2021-top25\":true,\"cwe2022-top25\":true,\"impact\":\"MEDIUM\",\"license\":\"Commons Clause License Condition v1.0[LGPL-2.1-only]\",\"likelihood\":\"MEDIUM\",\"owasp\":[\"A10:2021 - Server-Side Request Forgery (SSRF)\"],\"references\":[\"https:\\/\\/owasp.org\\/Top10\\/A10_2021-Server-Side_Request_Forgery_%28SSRF%29\"],\"semgrep.dev\":{\"rule\":{\"origin\":\"community\",\"r_id\":16250,\"rule_id\":\"5rUpro\",\"rv_id\":110042,\"url\":\"https:\\/\\/semgrep.dev\\/playground\\/r\\/K3Tvjky\\/php.lang.security.injection.tainted-filename.tainted-filename\",\"version_id\":\"K3Tvjky\"}},\"shortlink\":\"https:\\/\\/sg.run\\/Ayqp\",\"source\":\"https:\\/\\/semgrep.dev\\/r\\/php.lang.security.injection.tainted-filename.tainted-filename\",\"subcategory\":[\"vuln\"],\"technology\":[\"php\"],\"vulnerability_class\":[\"Server-Side Request Forgery (SSRF)\"]},\"metavars\":{\"$FILENAME\":{\"abstract_content\":\"$_SERVER[\\\"DOCUMENT_ROOT\\\"].$_SERVER[\\\"SCRIPT_NAME\\\"]\",\"end\":{\"col\":64,\"line\":13,\"offset\":666},\"start\":{\"col\":13,\"line\":13,\"offset\":615}}},\"severity\":\"WARNING\",\"validation_state\":\"NO_VALIDATOR\"}', 'public/router.php', '{\"col\":13,\"line\":13,\"offset\":615}', 'https://gitee.com/songboy/swallow.git', 0);

-- ----------------------------
-- Table structure for user
-- ----------------------------
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `password` char(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `is_admin` int(11) NULL DEFAULT 0,
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE INDEX `un_username`(`username`) USING BTREE
) ENGINE = MyISAM AUTO_INCREMENT = 5 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of user
-- ----------------------------
INSERT INTO `user` VALUES (3, 'admin', 'cc03e747a6afbbcbf8be7668acfebee5', '2024-05-10 23:05:26', '2024-05-10 23:05:26', 1);
INSERT INTO `user` VALUES (4, 'abc', '4297f44b13955235245b2497399d7a93', '2024-05-12 21:09:55', '2024-05-12 21:09:55', 0);

-- ----------------------------
-- Table structure for git_addr
-- ----------------------------
DROP TABLE IF EXISTS `git_addr`;
CREATE TABLE `git_addr`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_id` int(11) NULL DEFAULT 0,
  `git_addr` varchar(512) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT '',
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `semgrep_scan_time` datetime NULL DEFAULT '2000-01-01 00:00:00',
  `mofei_scan_time` datetime NULL DEFAULT NULL,
  `fortify_scan_time` datetime NULL DEFAULT '2000-01-01 00:00:00',
  `hema_scan_time` datetime NULL DEFAULT '2000-01-01 00:00:00',
  `code_path` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL COMMENT '代码存放路径',
  `codeql_scan_time` datetime NULL DEFAULT '2000-01-01 00:00:00',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 4 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of git_addr
-- ----------------------------
INSERT INTO `git_addr` VALUES (2, 2, 'https://gitee.com/songboy/QingScan.git', '2024-05-14 20:20:00', '2024-05-14 20:20:33', NULL, '2024-05-14 20:22:44', '2024-05-27 22:19:00', '/data/code/swallow', '2024-06-15 20:47:24');
INSERT INTO `git_addr` VALUES (3, 3, 'https://gitee.com/open_source_official_website/kcweb.git', '2024-06-15 20:16:10', '2000-01-01 00:00:00', NULL, '2000-01-01 00:00:00', '2000-01-01 00:00:00', '/data/code/kcweb', '2024-05-31 00:44:29');

-- ----------------------------
-- Table structure for project_conf
-- ----------------------------
DROP TABLE IF EXISTS `project_conf`;
CREATE TABLE `project_conf`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `key` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `value` text CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL,
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  `project_id` int(11) NULL DEFAULT 1,
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE INDEX `un_key`(`project_id` ASC, `key` ASC) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of project_conf
-- ----------------------------

-- ----------------------------
-- Table structure for project
-- ----------------------------
DROP TABLE IF EXISTS `project`;
CREATE TABLE `project`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(512) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT '',
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `desc` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NULL DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE INDEX `un_domain`(`name` ASC) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 4 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of project
-- ----------------------------
INSERT INTO `project` VALUES (2, 'test', '2024-05-14 20:20:00', 'dfsdf');
INSERT INTO `project` VALUES (3, 'kcweb', '2024-06-15 20:16:10', 'kcweb');

-- ----------------------------
-- Table structure for murphysec
-- ----------------------------
DROP TABLE IF EXISTS `murphysec`;
CREATE TABLE `murphysec`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_id` int(11) NULL DEFAULT 1,
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `comp_name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `show_level` int(11) NULL DEFAULT NULL,
  `min_fixed_version` varchar(30) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `dispose_plan` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `version` varchar(30) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `license` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `is_direct_dependency` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `language` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `fix_type` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `comp_sec_score` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_bin ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of murphysec
-- ----------------------------

-- ----------------------------
-- Table structure for mf_vulns
-- ----------------------------
DROP TABLE IF EXISTS `mf_vulns`;
CREATE TABLE `mf_vulns`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_id` int(11) NULL DEFAULT 1,
  `cve_id` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `description` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `level` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `influence` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `poc` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `publish_time` int(11) NULL DEFAULT NULL,
  `affected_version` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `min_fixed_version` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `references` text CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL,
  `solutions` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `suggest_level` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `vuln_no` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `vuln_path` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `title` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `git_addr` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NULL DEFAULT NULL,
  `is_repair` int(11) NULL DEFAULT 0,
  `create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_bin ROW_FORMAT = Dynamic;

-- ----------------------------
-- Records of mf_vulns
-- ----------------------------

SET FOREIGN_KEY_CHECKS = 1;
